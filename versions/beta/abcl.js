!function(){"use strict";var e={};!function(e){!function(){const t="1.2.0";function n(e){alert("Mod ERROR:\n"+e);const t=new Error(e);throw console.error(t),t}const s=new TextEncoder;function i(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function o(e){const t=new Set;return e.filter((e=>!t.has(e)&&t.add(e)))}const a=new Map,r=new Set;function l(e){r.has(e)||(r.add(e),console.warn(e))}function c(e){const t=[],n=new Map,s=new Set;for(const i of p.values()){const o=i.patching.get(e.name);if(o){t.push(...o.hooks);for(const[t,a]of o.patches.entries())n.has(t)&&n.get(t)!==a&&l(`ModSDK: Mod '${i.name}' is patching function ${e.name} with same pattern that is already applied by different mod, but with different pattern:\nPattern:\n${t}\nPatch1:\n${n.get(t)||""}\nPatch2:\n${a}`),n.set(t,a),s.add(i.name)}}t.sort(((e,t)=>t.priority-e.priority));const i=function(e,t){if(0===t.size)return e;let n=e.toString().replaceAll("\r\n","\n");for(const[s,i]of t.entries())n.includes(s)||l(`ModSDK: Patching ${e.name}: Patch ${s} not applied`),n=n.replaceAll(s,i);return(0,eval)(`(${n})`)}(e.original,n);let o=function(t){var n,o;const a=null===(o=(n=b.errorReporterHooks).hookChainExit)||void 0===o?void 0:o.call(n,e.name,s),r=i.apply(this,t);return null==a||a(),r};for(let n=t.length-1;n>=0;n--){const s=t[n],i=o;o=function(t){var n,o;const a=null===(o=(n=b.errorReporterHooks).hookEnter)||void 0===o?void 0:o.call(n,e.name,s.mod),r=s.hook.apply(this,[t,e=>{if(1!==arguments.length||!Array.isArray(t))throw new Error(`Mod ${s.mod} failed to call next hook: Expected args to be array, got ${typeof e}`);return i.call(this,e)}]);return null==a||a(),r}}return{hooks:t,patches:n,patchesSources:s,enter:o,final:i}}function u(e,t=!1){let n=a.get(e);if(n)t&&(n.precomputed=c(n));else{let t=window;const o=e.split(".");for(let n=0;n<o.length-1;n++)if(t=t[o[n]],!i(t))throw new Error(`ModSDK: Function ${e} to be patched not found; ${o.slice(0,n+1).join(".")} is not object`);const r=t[o[o.length-1]];if("function"!=typeof r)throw new Error(`ModSDK: Function ${e} to be patched not found`);const l=function(e){let t=-1;for(const n of s.encode(e)){let e=255&(t^n);for(let t=0;t<8;t++)e=1&e?-306674912^e>>>1:e>>>1;t=t>>>8^e}return(~t>>>0).toString(16).padStart(8,"0").toUpperCase()}(r.toString().replaceAll("\r\n","\n")),u={name:e,original:r,originalHash:l};n=Object.assign(Object.assign({},u),{precomputed:c(u),router:()=>{},context:t,contextProperty:o[o.length-1]}),n.router=function(e){return function(...t){return e.precomputed.enter.apply(this,[t])}}(n),a.set(e,n),t[n.contextProperty]=n.router}return n}function d(){for(const e of a.values())e.precomputed=c(e)}function m(){const e=new Map;for(const[t,n]of a)e.set(t,{name:t,original:n.original,originalHash:n.originalHash,sdkEntrypoint:n.router,currentEntrypoint:n.context[n.contextProperty],hookedByMods:o(n.precomputed.hooks.map((e=>e.mod))),patchedByMods:Array.from(n.precomputed.patchesSources)});return e}const p=new Map;function h(e){p.get(e.name)!==e&&n(`Failed to unload mod '${e.name}': Not registered`),p.delete(e.name),e.loaded=!1,d()}function g(e,t){e&&"object"==typeof e||n("Failed to register mod: Expected info object, got "+typeof e),"string"==typeof e.name&&e.name||n("Failed to register mod: Expected name to be non-empty string, got "+typeof e.name);let s=`'${e.name}'`;"string"==typeof e.fullName&&e.fullName||n(`Failed to register mod ${s}: Expected fullName to be non-empty string, got ${typeof e.fullName}`),s=`'${e.fullName} (${e.name})'`,"string"!=typeof e.version&&n(`Failed to register mod ${s}: Expected version to be string, got ${typeof e.version}`),e.repository||(e.repository=void 0),void 0!==e.repository&&"string"!=typeof e.repository&&n(`Failed to register mod ${s}: Expected repository to be undefined or string, got ${typeof e.version}`),null==t&&(t={}),t&&"object"==typeof t||n(`Failed to register mod ${s}: Expected options to be undefined or object, got ${typeof t}`);const o=!0===t.allowReplace,a=p.get(e.name);a&&(a.allowReplace&&o||n(`Refusing to load mod ${s}: it is already loaded and doesn't allow being replaced.\nWas the mod loaded multiple times?`),h(a));const r=e=>{let t=m.patching.get(e.name);return t||(t={hooks:[],patches:new Map},m.patching.set(e.name,t)),t},l=(e,t)=>(...i)=>{var o,a;const r=null===(a=(o=b.errorReporterHooks).apiEndpointEnter)||void 0===a?void 0:a.call(o,e,m.name);m.loaded||n(`Mod ${s} attempted to call SDK function after being unloaded`);const l=t(...i);return null==r||r(),l},c={unload:l("unload",(()=>h(m))),hookFunction:l("hookFunction",((e,t,i)=>{"string"==typeof e&&e||n(`Mod ${s} failed to patch a function: Expected function name string, got ${typeof e}`);const o=u(e),a=r(o);"number"!=typeof t&&n(`Mod ${s} failed to hook function '${e}': Expected priority number, got ${typeof t}`),"function"!=typeof i&&n(`Mod ${s} failed to hook function '${e}': Expected hook function, got ${typeof i}`);const l={mod:m.name,priority:t,hook:i};return a.hooks.push(l),d(),()=>{const e=a.hooks.indexOf(l);e>=0&&(a.hooks.splice(e,1),d())}})),patchFunction:l("patchFunction",((e,t)=>{"string"==typeof e&&e||n(`Mod ${s} failed to patch a function: Expected function name string, got ${typeof e}`);const o=u(e),a=r(o);i(t)||n(`Mod ${s} failed to patch function '${e}': Expected patches object, got ${typeof t}`);for(const[i,o]of Object.entries(t))"string"==typeof o?a.patches.set(i,o):null===o?a.patches.delete(i):n(`Mod ${s} failed to patch function '${e}': Invalid format of patch '${i}'`);d()})),removePatches:l("removePatches",(e=>{"string"==typeof e&&e||n(`Mod ${s} failed to patch a function: Expected function name string, got ${typeof e}`);const t=u(e);r(t).patches.clear(),d()})),callOriginal:l("callOriginal",((e,t,i)=>{"string"==typeof e&&e||n(`Mod ${s} failed to call a function: Expected function name string, got ${typeof e}`);const o=u(e);return Array.isArray(t)||n(`Mod ${s} failed to call a function: Expected args array, got ${typeof t}`),o.original.apply(null!=i?i:globalThis,t)})),getOriginalHash:l("getOriginalHash",(e=>("string"==typeof e&&e||n(`Mod ${s} failed to get hash: Expected function name string, got ${typeof e}`),u(e).originalHash)))},m={name:e.name,fullName:e.fullName,version:e.version,repository:e.repository,allowReplace:o,api:c,loaded:!0,patching:new Map};return p.set(e.name,m),Object.freeze(c)}function f(){const e=[];for(const t of p.values())e.push({name:t.name,fullName:t.fullName,version:t.version,repository:t.repository});return e}let b;const v=void 0===window.bcModSdk?window.bcModSdk=function(){const e={version:t,apiVersion:1,registerMod:g,getModsInfo:f,getPatchingInfo:m,errorReporterHooks:Object.seal({apiEndpointEnter:null,hookEnter:null,hookChainExit:null})};return b=e,Object.freeze(e)}():(i(window.bcModSdk)||n("Failed to init Mod SDK: Name already in use"),1!==window.bcModSdk.apiVersion&&n(`Failed to init Mod SDK: Different version already loaded ('1.2.0' vs '${window.bcModSdk.version}')`),window.bcModSdk.version!==t&&alert(`Mod SDK warning: Loading different but compatible versions ('1.2.0' vs '${window.bcModSdk.version}')\nOne of mods you are using is using an old version of SDK. It will work for now but please inform author to update`),window.bcModSdk);Object.defineProperty(e,"__esModule",{value:!0}),e.default=v}()}(e);var t=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(e);const n=new class{constructor(){this.logsArray=[],this.maxLogSize=100}log(e,t,n){const s={message:t,level:e,version:"2.1.0",timestamp:(new Date).toISOString()};n("%cABCL:","font-weight: bold; color: #f6cbde;",s),this.logsArray.push(s),this.logsArray.length>this.maxLogSize&&this.logsArray.shift()}info(e){this.log("INFO",e,console.log)}debug(e){this.log("DEBUG",e,console.debug)}warn(e){this.log("WARN",e,console.warn)}error(e){this.log("ERROR",e,console.error)}getLogs(){return this.logsArray}};var s="object"==typeof global&&global&&global.Object===Object&&global,i="object"==typeof self&&self&&self.Object===Object&&self,o=s||i||Function("return this")(),a=o.Symbol,r=Object.prototype,l=r.hasOwnProperty,c=r.toString,u=a?a.toStringTag:void 0;var d=Object.prototype.toString;var m="[object Null]",p="[object Undefined]",h=a?a.toStringTag:void 0;function g(e){return null==e?void 0===e?p:m:h&&h in Object(e)?function(e){var t=l.call(e,u),n=e[u];try{e[u]=void 0;var s=!0}catch(e){}var i=c.call(e);return s&&(t?e[u]=n:delete e[u]),i}(e):function(e){return d.call(e)}(e)}function f(e){return null!=e&&"object"==typeof e}var b="[object Symbol]";var v=Array.isArray,y=/\s/;var A=/^\s+/;function C(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&y.test(e.charAt(t)););return t}(e)+1).replace(A,""):e}function P(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var S=NaN,w=/^[-+]0x[0-9a-f]+$/i,M=/^0b[01]+$/i,B=/^0o[0-7]+$/i,L=parseInt;function D(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||f(e)&&g(e)==b}(e))return S;if(P(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=P(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=C(e);var n=M.test(e);return n||B.test(e)?L(e.slice(2),n?2:8):w.test(e)?S:+e}function k(e){return e}var I="[object AsyncFunction]",x="[object Function]",N="[object GeneratorFunction]",T="[object Proxy]";function _(e){if(!P(e))return!1;var t=g(e);return t==x||t==N||t==I||t==T}var F,$=o["__core-js_shared__"],O=(F=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||""))?"Symbol(src)_1."+F:"";var z=Function.prototype.toString;var G=/^\[object .+?Constructor\]$/,R=Function.prototype,j=Object.prototype,V=R.toString,W=j.hasOwnProperty,H=RegExp("^"+V.call(W).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function U(e){return!(!P(e)||(t=e,O&&O in t))&&(_(e)?H:G).test(function(e){if(null!=e){try{return z.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function Y(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return U(n)?n:void 0}var q=Object.create,X=function(){function e(){}return function(t){if(!P(t))return{};if(q)return q(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var K=Date.now;var J,Z,Q,ee=function(){try{var e=Y(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),te=ee?function(e,t){return ee(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:k,ne=(J=te,Z=0,Q=0,function(){var e=K(),t=16-(e-Q);if(Q=e,t>0){if(++Z>=800)return arguments[0]}else Z=0;return J.apply(void 0,arguments)}),se=9007199254740991,ie=/^(?:0|[1-9]\d*)$/;function oe(e,t){var n=typeof e;return!!(t=null==t?se:t)&&("number"==n||"symbol"!=n&&ie.test(e))&&e>-1&&e%1==0&&e<t}function ae(e,t,n){"__proto__"==t&&ee?ee(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function re(e,t){return e===t||e!=e&&t!=t}var le=Object.prototype.hasOwnProperty;function ce(e,t,n){var s=e[t];le.call(e,t)&&re(s,n)&&(void 0!==n||t in e)||ae(e,t,n)}var ue=Math.max;function de(e,t){return ne(function(e,t,n){return t=ue(void 0===t?e.length-1:t,0),function(){for(var s=arguments,i=-1,o=ue(s.length-t,0),a=Array(o);++i<o;)a[i]=s[t+i];i=-1;for(var r=Array(t+1);++i<t;)r[i]=s[i];return r[t]=n(a),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,r)}}(e,t,k),e+"")}var me=9007199254740991;function pe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=me}function he(e){return null!=e&&pe(e.length)&&!_(e)}var ge=Object.prototype;function fe(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||ge)}function be(e){return f(e)&&"[object Arguments]"==g(e)}var ve=Object.prototype,ye=ve.hasOwnProperty,Ae=ve.propertyIsEnumerable,Ce=be(function(){return arguments}())?be:function(e){return f(e)&&ye.call(e,"callee")&&!Ae.call(e,"callee")},Pe=Ce;var Se="object"==typeof exports&&exports&&!exports.nodeType&&exports,we=Se&&"object"==typeof module&&module&&!module.nodeType&&module,Me=we&&we.exports===Se?o.Buffer:void 0,Be=(Me?Me.isBuffer:void 0)||function(){return!1},Le={};Le["[object Float32Array]"]=Le["[object Float64Array]"]=Le["[object Int8Array]"]=Le["[object Int16Array]"]=Le["[object Int32Array]"]=Le["[object Uint8Array]"]=Le["[object Uint8ClampedArray]"]=Le["[object Uint16Array]"]=Le["[object Uint32Array]"]=!0,Le["[object Arguments]"]=Le["[object Array]"]=Le["[object ArrayBuffer]"]=Le["[object Boolean]"]=Le["[object DataView]"]=Le["[object Date]"]=Le["[object Error]"]=Le["[object Function]"]=Le["[object Map]"]=Le["[object Number]"]=Le["[object Object]"]=Le["[object RegExp]"]=Le["[object Set]"]=Le["[object String]"]=Le["[object WeakMap]"]=!1;var De="object"==typeof exports&&exports&&!exports.nodeType&&exports,ke=De&&"object"==typeof module&&module&&!module.nodeType&&module,Ie=ke&&ke.exports===De&&s.process,xe=function(){try{var e=ke&&ke.require&&ke.require("util").types;return e||Ie&&Ie.binding&&Ie.binding("util")}catch(e){}}(),Ne=xe&&xe.isTypedArray,Te=Ne?function(e){return function(t){return e(t)}}(Ne):function(e){return f(e)&&pe(e.length)&&!!Le[g(e)]},Ee=Object.prototype.hasOwnProperty;function _e(e,t){var n=v(e),s=!n&&Pe(e),i=!n&&!s&&Be(e),o=!n&&!s&&!i&&Te(e),a=n||s||i||o,r=a?function(e,t){for(var n=-1,s=Array(e);++n<e;)s[n]=t(n);return s}(e.length,String):[],l=r.length;for(var c in e)!t&&!Ee.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||oe(c,l))||r.push(c);return r}var Fe=Object.prototype.hasOwnProperty;function $e(e){if(!P(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=fe(e),n=[];for(var s in e)("constructor"!=s||!t&&Fe.call(e,s))&&n.push(s);return n}function Oe(e){return he(e)?_e(e,!0):$e(e)}var ze=Y(Object,"create");var Ge=Object.prototype.hasOwnProperty;var Re=Object.prototype.hasOwnProperty;function je(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}function Ve(e,t){for(var n=e.length;n--;)if(re(e[n][0],t))return n;return-1}je.prototype.clear=function(){this.__data__=ze?ze(null):{},this.size=0},je.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},je.prototype.get=function(e){var t=this.__data__;if(ze){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Ge.call(t,e)?t[e]:void 0},je.prototype.has=function(e){var t=this.__data__;return ze?void 0!==t[e]:Re.call(t,e)},je.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ze&&void 0===t?"__lodash_hash_undefined__":t,this};var We=Array.prototype.splice;function He(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}He.prototype.clear=function(){this.__data__=[],this.size=0},He.prototype.delete=function(e){var t=this.__data__,n=Ve(t,e);return!(n<0)&&(n==t.length-1?t.pop():We.call(t,n,1),--this.size,!0)},He.prototype.get=function(e){var t=this.__data__,n=Ve(t,e);return n<0?void 0:t[n][1]},He.prototype.has=function(e){return Ve(this.__data__,e)>-1},He.prototype.set=function(e,t){var n=this.__data__,s=Ve(n,e);return s<0?(++this.size,n.push([e,t])):n[s][1]=t,this};var Ue=Y(o,"Map");function Ye(e,t){var n,s,i=e.__data__;return("string"==(s=typeof(n=t))||"number"==s||"symbol"==s||"boolean"==s?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function qe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}qe.prototype.clear=function(){this.size=0,this.__data__={hash:new je,map:new(Ue||He),string:new je}},qe.prototype.delete=function(e){var t=Ye(this,e).delete(e);return this.size-=t?1:0,t},qe.prototype.get=function(e){return Ye(this,e).get(e)},qe.prototype.has=function(e){return Ye(this,e).has(e)},qe.prototype.set=function(e,t){var n=Ye(this,e),s=n.size;return n.set(e,t),this.size+=n.size==s?0:1,this};var Xe=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object),Ke="[object Object]",Je=Function.prototype,Ze=Object.prototype,Qe=Je.toString,et=Ze.hasOwnProperty,tt=Qe.call(Object);function nt(e){var t=this.__data__=new He(e);this.size=t.size}nt.prototype.clear=function(){this.__data__=new He,this.size=0},nt.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},nt.prototype.get=function(e){return this.__data__.get(e)},nt.prototype.has=function(e){return this.__data__.has(e)},nt.prototype.set=function(e,t){var n=this.__data__;if(n instanceof He){var s=n.__data__;if(!Ue||s.length<199)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new qe(s)}return n.set(e,t),this.size=n.size,this};var st="object"==typeof exports&&exports&&!exports.nodeType&&exports,it=st&&"object"==typeof module&&module&&!module.nodeType&&module,ot=it&&it.exports===st?o.Buffer:void 0,at=ot?ot.allocUnsafe:void 0;var rt=o.Uint8Array;function lt(e,t){var n,s,i=t?(n=e.buffer,s=new n.constructor(n.byteLength),new rt(s).set(new rt(n)),s):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var ct,ut=function(e,t,n){for(var s=-1,i=Object(e),o=n(e),a=o.length;a--;){var r=o[ct?a:++s];if(!1===t(i[r],r,i))break}return e},dt=function(){return o.Date.now()},mt="Expected a function",pt=Math.max,ht=Math.min;function gt(e,t,n){var s,i,o,a,r,l,c=0,u=!1,d=!1,m=!0;if("function"!=typeof e)throw new TypeError(mt);function p(t){var n=s,o=i;return s=i=void 0,c=t,a=e.apply(o,n)}function h(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-c>=o}function g(){var e=dt();if(h(e))return f(e);r=setTimeout(g,function(e){var n=t-(e-l);return d?ht(n,o-(e-c)):n}(e))}function f(e){return r=void 0,m&&s?p(e):(s=i=void 0,a)}function b(){var e=dt(),n=h(e);if(s=arguments,i=this,l=e,n){if(void 0===r)return function(e){return c=e,r=setTimeout(g,t),u?p(e):a}(l);if(d)return clearTimeout(r),r=setTimeout(g,t),p(l)}return void 0===r&&(r=setTimeout(g,t)),a}return t=D(t)||0,P(n)&&(u=!!n.leading,o=(d="maxWait"in n)?pt(D(n.maxWait)||0,t):o,m="trailing"in n?!!n.trailing:m),b.cancel=function(){void 0!==r&&clearTimeout(r),c=0,s=l=i=r=void 0},b.flush=function(){return void 0===r?a:f(dt())},b}function ft(e,t,n){(void 0!==n&&!re(e[t],n)||void 0===n&&!(t in e))&&ae(e,t,n)}function bt(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function vt(e){return function(e,t,n,s){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var r=t[o],l=s?s(n[r],e[r],r,n,e):void 0;void 0===l&&(l=e[r]),i?ae(n,r,l):ce(n,r,l)}return n}(e,Oe(e))}function yt(e,t,n,s,i,o,a){var r=bt(e,n),l=bt(t,n),c=a.get(l);if(c)ft(e,n,c);else{var u,d=o?o(r,l,n+"",e,t,a):void 0,m=void 0===d;if(m){var p=v(l),h=!p&&Be(l),b=!p&&!h&&Te(l);d=l,p||h||b?v(r)?d=r:f(u=r)&&he(u)?d=function(e,t){var n=-1,s=e.length;for(t||(t=Array(s));++n<s;)t[n]=e[n];return t}(r):h?(m=!1,d=function(e,t){if(t)return e.slice();var n=e.length,s=at?at(n):new e.constructor(n);return e.copy(s),s}(l,!0)):b?(m=!1,d=lt(l,!0)):d=[]:function(e){if(!f(e)||g(e)!=Ke)return!1;var t=Xe(e);if(null===t)return!0;var n=et.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Qe.call(n)==tt}(l)||Pe(l)?(d=r,Pe(r)?d=vt(r):P(r)&&!_(r)||(d=function(e){return"function"!=typeof e.constructor||fe(e)?{}:X(Xe(e))}(l))):m=!1}m&&(a.set(l,d),i(d,l,s,o,a),a.delete(l)),ft(e,n,d)}}function At(e,t,n,s,i){e!==t&&ut(t,(function(o,a){if(i||(i=new nt),P(o))yt(e,t,a,n,At,s,i);else{var r=s?s(bt(e,a),o,a+"",e,t,i):void 0;void 0===r&&(r=o),ft(e,a,r)}}),Oe)}var Ct,Pt=(Ct=function(e,t,n){At(e,t,n)},de((function(e,t){var n=-1,s=t.length,i=s>1?t[s-1]:void 0,o=s>2?t[2]:void 0;for(i=Ct.length>3&&"function"==typeof i?(s--,i):void 0,o&&function(e,t,n){if(!P(n))return!1;var s=typeof t;return!!("number"==s?he(n)&&oe(t,n.length):"string"==s&&t in n)&&re(n[t],e)}(t[0],t[1],o)&&(i=s<3?void 0:i,s=1),e=Object(e);++n<s;){var a=t[n];a&&Ct(e,a,n,i)}return e})));const St={ItemDefinitions:{BabyItems:["Bows Dress","Babydoll Dress","Puffy Dress","Shiny dress","Summmer flower dress","Adult Baby Harness","Tutu","Frilled Bikni","Padded Mittens","Paw Mittens","Short Smooth Leather Mittens","Changing Table","Crib","Fox Plush","Bunny Plush","Shark Plush"],Pants:["Long Leggings","Short Leggings","Business Trousers","Latex Pants","Long Latex Pants","Ripped Jeans","Jeans","Pajama"]},DiaperColors:{clean:"#8F8F8F",middlewet:"#ffe58b",maximumwet:"#ffd33e",middlemess:"#423019",maximummess:"#3C302C",selfwet:"#242103",selfmess:"#1f170d",indicatorAccident:"#1e47a6"},DiaperSizeScale:{none:0,small:300,regular:500,overnight:800,light_adult:900,moderate_adult:1500,heavy_adult:2500,specialized:3500},Diapers:{"Patterned Diaper":{color:[0],size:"overnight"},"Bulky Diaper":{color:[0,1],size:"light_adult"},"Bulky Chastity Diaper":{color:[1,0],size:"moderate_adult"},"Poofy Diaper":{color:[1,0],size:"light_adult"},"Poofy Chastity Diaper 1":{color:[1,0],size:"heavy_adult"},"Poofy Chastity Diaper":{color:[1,0],size:"moderate_adult"},"Plastic Covered Diaper":{color:[0],size:"light_adult"},"Satin Covered Diaper":{color:[0],size:"light_adult"},Diaper:{size:"regular"},"Diaper Harness":{size:"none"},"Untrainers Diaper":{size:"overnight",gradients:[1],indicator:[6]},"Cutest Diaper":{size:"light_adult",gradients:[4],indicator:[5]}}},wt={Tickle:{wetting:.05,messing:.01},TickleItem:{wetting:.08,messing:.01},Spank:{wetting:.12,messing:.15},ShockItem:{wetting:.15,messing:.2},Kick:{wetting:.05,messing:.05},Rub:{wetting:.01},SpankItem:{wetting:.15,messing:.2},Slap:{wetting:.03,messing:.04},Grope:{wetting:.06,messing:.05}},Mt="2.1.0",Bt="ABCL",Lt="ABCL",Dt="Normal",kt="Deny",It="Ask",xt="Allow",Nt={Disabled:0,Slow:.5,Normal:1,Fast:1.5,Faster:2,Fastest:3};var Tt;!function(e){e[e.Anyone=0]="Anyone",e[e.ItemPermission=1]="ItemPermission",e[e.Friends=2]="Friends",e[e.Lovers=3]="Lovers",e[e.Owner=5]="Owner",e[e.Self=6]="Self"}(Tt||(Tt={}));const Et={PeeMetabolism:Dt,PoopMetabolism:Dt,OpenRemoteSettings:!1,LockedOutOfSettings:!1,DisableWettingLeaks:!1,DisableSoilingLeaks:!0,OnDiaperChange:It,VisibleMessages:{changeDiaper:!0,checkDiaper:!0,lickPuddle:!0,wetDiaper:!0,wetClothing:!0,soilDiaper:!0,soilClothing:!0,usePotty:!0,useToilet:!0,wipePuddle:!0,statusMessages:!1},StatusMessages:{Bladder:!0,Bowel:!0,Soiliness:!0,Wetness:!0,MentalRegression:!0,Incontinence:!0,PuddleSize:!0},DisableClothingStains:!1,DisableDiaperStains:!1,AccidentsByActivities:!0},_t={PuddleSize:{value:0},Bladder:{value:0,size:300},Bowel:{value:0,size:200},Soiliness:{value:0},Wetness:{value:0},WaterIntake:{value:15},FoodIntake:{value:200/60},Incontinence:{value:0},MentalRegression:{value:0}},Ft={Settings:Et,Stats:_t},$t=gt((()=>{const e=LZString.compressToBase64(JSON.stringify(Player.ABCL));Player.ExtensionSettings.ABCL=e,ServerPlayerExtensionSettingsSync("ABCL"),Zn()}),1e3),Ot=t.registerMod({name:Bt,fullName:Bt,version:Mt,repository:"https://github.com/zoe-64/ABCL"});var zt;!function(e){e[e.OBSERVE=0]="OBSERVE",e[e.ADD_BEHAVIOR=1]="ADD_BEHAVIOR",e[e.MODIFY_BEHAVIOR=5]="MODIFY_BEHAVIOR",e[e.OVERRIDE_BEHAVIOR=10]="OVERRIDE_BEHAVIOR",e[e.TOP=100]="TOP"}(zt||(zt={}));const Gt=(e,t=[],n,s=!0)=>{if(!ServerPlayerIsInChatRoom())return;const i=document.createElement("div");i.innerHTML=(s?"(local) ":"")+e.split("\n").map((e=>e.trim())).join("<br/>"),i.classList.add("ABCLLocalMessage","ChatMessage",...t),n&&(i.style.cssText=n),document.querySelector("#TextAreaChatLog")?.appendChild(i),ElementScrollToEnd("TextAreaChatLog")};const Rt=async(e,t={})=>new Promise(((n,s)=>{const i=document.querySelector(e);if(i)return void n(i);const o=new MutationObserver((()=>{const s=document.querySelector(e);s&&(!t.childCheck||s.childElementCount>0)&&(o.disconnect(),clearTimeout(a),n(s))}));o.observe(document.body,{childList:!0,subtree:!0});const a=setTimeout((()=>{o.disconnect(),console.warn(`Element with selector "${e}" not found within timeout`)}),t.timeout||1e4)}));const jt=e=>"Default"!==e&&"string"==typeof e,Vt=(e,t)=>("string"==typeof e&&"Default"!==e&&n.warn(`Unknown color: ${e}`),e&&"Default"!==e?Array.isArray(e)?e.map((e=>"Default"===e?"#FFFFFF":e)):[e]:[...t.DefaultColor.map((e=>"Default"===e?"#FFFFFF":e))]),Wt=(e,t)=>{const n=e.querySelector(t);if(n)return n;throw new Error(`Element with selector "${t}" not found`)};function Ht(e){let t=0,n=0,s=0;return 7===e.length&&(t=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),s=parseInt(e.substring(5,7),16)),Ut(t,n,s)}function Ut(e,t,n){e/=255,t/=255,n/=255;let s,i=Math.max(e,t,n),o=Math.min(e,t,n),a=0,r=(i+o)/2;if(i===o)a=s=0;else{let l=i-o;switch(s=r>.5?l/(2-i-o):l/(i+o),i){case e:a=(t-n)/l+(t<n?6:0);break;case t:a=(n-e)/l+2;break;case n:a=(e-t)/l+4}a*=60}return`hsl(${Math.round(a)}, ${Math.round(100*s)}%, ${Math.round(100*r)}%)`}function Yt(e,t,n){let s=function(e){let t=getComputedStyle(document.documentElement).getPropertyValue(e).trim();if(!t)return"";if(t.startsWith("#"))return Ht(t);const n=t.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(n){const[e,t,s]=n.slice(1,4).map(Number);return Ut(e,t,s)}return t.match(/hsl\((\d+),\s*(\d+)%?,\s*(\d+)%?\)/)?t:""}(t);s||(s=n);return Object.entries({50:50,100:40,200:30,300:20,400:10,500:5,600:0,700:-10,800:-20,900:-30,950:-40}).map((([t,n])=>`  --sl-${e}-${t}: ${function(e,t){const n=e.match(/hsl\((\d+),\s*(\d+)%?,\s*(\d+)%?\)/);if(!n)return e;let s=parseInt(n[1],10),i=parseInt(n[2],10),o=parseInt(n[3],10);return o=Math.min(100,Math.max(0,o+t)),`hsl(${s}, ${i}%, ${o}%)`}(s,n)};`)).join("\n")}const qt=e=>{if(!e)return;if("object"==typeof e)return e;return ChatRoomCharacter.filter((t=>{const n=t.Name.toLowerCase(),s=t.Nickname?.toLowerCase(),i=`${e}`.toLowerCase();return t.MemberNumber==e||n===i||s===i||n.startsWith(i)||s?.startsWith(i)}))[0]},Xt=e=>{const t=e.join(" "),n=qt(t);if(n)return n},Kt=(e,t,n=Player.ABCL.Version)=>Boolean(e?.ABCL&&(!t||e.ABCL.Version===n));function Jt(e){if(!e)return"Unknown";const t=qt(e);return t?t.Nickname?t.Nickname:t.Name:"Unknown"}function Zt(e,t=null,n=""){let s=e,i="He/Him"===CharacterPronounDescription(Player),o=i?"His":"Her",a=i?"Him":"Her",r=i?"He":"She",l="He/Him"===(t?CharacterPronounDescription(t):"They/Them"),c=t?.IsPlayer()?l?"himself":"herself":t?CharacterNickname(t):n,u=l?"His":"Her",d=t==Player?l?"Himself":"Herself":l?"Him":"Her",m=l?"He":"She";return s.replaceAll("%NAME%",CharacterNickname(Player)).replaceAll("%POSSESSIVE%",o.toLocaleLowerCase()).replaceAll("%PRONOUN%",r.toLocaleLowerCase()).replaceAll("%INTENSIVE%",a.toLocaleLowerCase()).replaceAll("%CAP_POSSESSIVE%",o).replaceAll("%CAP_PRONOUN%",r).replaceAll("%CAP_INTENSIVE%",a).replaceAll("%OPP_NAME%",c).replaceAll("%OPP_PRONOUN%",m.toLocaleLowerCase()).replaceAll("%OPP_POSSESSIVE%",u.toLocaleLowerCase()).replaceAll("%OPP_INTENSIVE%",d.toLocaleLowerCase()).replaceAll("%CAP_OPP_PRONOUN%",m).replaceAll("%CAP_OPP_POSSESSIVE%",u).replaceAll("%CAP_OPP_INTENSIVE%",d)}const Qt=(e,t,n=!1)=>{if(0===t)return;if(n&&(t*=100),t=Number(t.toPrecision(2)),!cn.settings.getStatusMessageSetting(e))return;const s=!cn.settings.getPublicMessage("statusMessages"),i=`[${t>0?"+":"-"}${Math.abs(t)}${n?"%":""} ${{Bladder:"PEE",Bowel:"POO",Incontinence:"INCON",MentalRegression:"REG",Soiliness:"MESS",Wetness:"WET",PuddleSize:"PUDL"}[e]}]`;s?Gt(i,["ChatMessageAction","ChatMessageNonDialogue"],"--label-color:#ff4949"):Jn("onABCLMessage",{message:`${Jt(Player.MemberNumber)}: ${i}`,local:s})};function en(e,t=null,n,s){let i=Zt(e,t);if(!n)return void ServerSend("ChatRoomChat",{Content:"Beep",Type:"Action",Dictionary:[{Tag:"Beep",Text:"msg"},{Tag:"发送私聊",Text:"msg"},{Tag:"Biep",Text:"msg"},{Tag:"Sonner",Text:"msg"},{Tag:"msg",Text:i}]});const o=!cn.settings.getPublicMessage(n);Gt(i,["ChatMessageAction","ChatMessageNonDialogue"],"--label-color:#ff4949",o),o?s&&s.MemberNumber!==Player.MemberNumber&&Jn("onABCLMessage",{message:i,local:o},s.MemberNumber):Jn("onABCLMessage",{message:i,local:o})}class tn{constructor(){this.folded=!1,this.statsDrawer=document.createElement("sl-drawer"),this.statsDrawer.innerHTML=`\n    <p class="ABCLWindowHeaderTitle">Stats</p>\n    <sl-select id="ABCLCurrentPlayerSelect" value="${Player.MemberNumber}">\n    </sl-select>\n\n  \n\t\t<div class="ABCLStatsWindowContent">\n      <label id="SoilinessPercentage">Soiliness</label>\n      <sl-progress-bar label="Soiliness" class="ABCLSoilinessPercentage"></sl-progress-bar>\n      <label id="WetnessPercentage">Wetness</label>\n      <sl-progress-bar label="Wetness" class="ABCLWetnessPercentage"></sl-progress-bar>\n      <label id="BowelFullness">Bowel</label>\n      <sl-progress-bar label="Bowel Fullness" class="ABCLBowelFullness"></sl-progress-bar>\n      <label id="BladderFullness">Bladder</label>\n      <sl-progress-bar label="Bladder Fullness" class="ABCLBladderFullness"></sl-progress-bar>\n      <label id="Incontinence">Incontinence</label>\n      <sl-progress-bar label="Incontinence" class="ABCLIncontinence"></sl-progress-bar>\n      <label id="MentalRegression">Mental Regression</label>\n      <sl-progress-bar label="Mental Regression" class="ABCLMentalRegression"></sl-progress-bar>\n\t\t</div>\n   <sl-button class="ABCLRefreshButton">Refresh</sl-button>\n\t`,on.appendChild(this.statsDrawer),this.statsDrawer.querySelector("#ABCLCurrentPlayerSelect")?.addEventListener("sl-change",(()=>this.update())),this.statsDrawer.querySelector(".ABCLRefreshButton")?.addEventListener("click",(()=>this.update())),this.update()}close(){this.statsDrawer.removeAttribute("open")}open(e){if(this.statsDrawer.setAttribute("open","true"),void 0!==e){const t=this.statsDrawer.querySelector("#ABCLCurrentPlayerSelect");t&&(t.value=e.toString())}this.update()}async update(){const e=this.statsDrawer.querySelector("#ABCLCurrentPlayerSelect");if(!e)return;let t=qt(e.value);t&&t?.ABCL||(t=Player),e.innerHTML="";for(let t of ChatRoomCharacter)t.ABCL&&(e.innerHTML+=`<sl-option value="${t.MemberNumber}">${Jt(t.MemberNumber)}</sl-option>`);const n=(e,t)=>{t=Math.round(t);const n=this.statsDrawer.querySelector(`.ABCL${e}`),s=this.statsDrawer.querySelector(`#${e}`);if(!n||!s)return;const i=Math.round(10*(t+Number.EPSILON))/10;t>100?(n.value="100",n.innerText=`overflowing ${Math.round((t-100)/(t/100))}%`,s.innerText=`${s.innerText.split(":")[0]}: overflowing ${i-100}%`):(n.value=i.toString(),n.innerText=i.toString()+"%",s.innerText=s.innerText.split(":")[0]+": "+i.toString()+"%")};t.ABCL&&(gn(t)?(n("SoilinessPercentage",t.ABCL.Stats.Soiliness.value/Cn(t)*100),n("WetnessPercentage",t.ABCL.Stats.Wetness.value/Cn(t)*100)):(n("SoilinessPercentage",0),n("WetnessPercentage",0)),n("BowelFullness",t.ABCL.Stats.Bowel.value/t.ABCL.Stats.Bowel.size*100),n("BladderFullness",t.ABCL.Stats.Bladder.value/t.ABCL.Stats.Bladder.size*100),n("Incontinence",100*t.ABCL.Stats.Incontinence.value),n("MentalRegression",100*t.ABCL.Stats.MentalRegression.value))}}class nn{constructor(e,t=!1){this.newX=0,this.newY=0,this.oldX=0,this.oldY=0,this.isDragging=!1,this.isResizing=!1,this.resizeDirection=null,this.edgeThreshold=10,this.resizable=!0,this.element=e,this.resizable=t,this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onMouseMoveForCursor=this.onMouseMoveForCursor.bind(this),this.element.addEventListener("mousedown",this.onMouseDown),this.element.addEventListener("mousemove",this.onMouseMoveForCursor),this.element.style.position="fixed",this.resizable&&(this.element.style.resize="none",this.element.addEventListener("mouseenter",this.onMouseEnter),this.element.addEventListener("mouseleave",this.onMouseLeave))}onMouseEnter(e){this.element.addEventListener("mousemove",this.onMouseMoveForCursor)}onMouseLeave(e){this.element.removeEventListener("mousemove",this.onMouseMoveForCursor),this.element.style.cursor="default"}onMouseMoveForCursor(e){const{offsetX:t,offsetY:n}=e,{offsetWidth:s,offsetHeight:i}=this.element;this.resizable&&(t<this.edgeThreshold||t>s-this.edgeThreshold?this.element.style.cursor="ew-resize":n<this.edgeThreshold||n>i-this.edgeThreshold?this.element.style.cursor="ns-resize":this.element.style.cursor="default")}onMouseDown(e){const{offsetX:t,offsetY:n}=e,{offsetWidth:s,offsetHeight:i}=this.element;this.resizable?t<this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="left"):t>s-this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="right"):n<this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="top"):n>i-this.edgeThreshold?(this.isResizing=!0,this.resizeDirection="bottom"):this.isDragging=!0:this.isDragging=!0,(this.isDragging||this.isResizing)&&(e.preventDefault(),this.oldX=e.clientX,this.oldY=e.clientY,document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp))}onMouseMove(e){if(this.isDragging)this.newX=this.oldX-e.clientX,this.newY=this.oldY-e.clientY,this.oldX=e.clientX,this.oldY=e.clientY,this.element.style.top=this.element.offsetTop-this.newY+"px",this.element.style.left=this.element.offsetLeft-this.newX+"px";else if(this.isResizing){const t=e.clientX-this.oldX,n=e.clientY-this.oldY,s=getComputedStyle(this.element),i=parseInt(s.left,10),o=parseInt(s.top,10),a=parseInt(s.width,10),r=parseInt(s.height,10);switch(this.resizeDirection){case"left":this.element.style.width=a-t+"px",this.element.style.left=`${i+t/2}px`;break;case"right":this.element.style.width=`${a+t}px`,this.element.style.left=`${i+t/2}px`;break;case"top":this.element.style.height=r-n+"px",this.element.style.top=`${o+n/2}px`;break;case"bottom":this.element.style.height=`${r+n}px`,this.element.style.top=`${o+n/2}px`}this.oldX=e.clientX,this.oldY=e.clientY}}onMouseUp(e){e.preventDefault(),this.isDragging=!1,this.isResizing=!1,this.resizeDirection=null,document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)}}class sn{constructor(e,t,n,s=-1){var i;this.prompt=document.createElement("div"),new nn(this.prompt),this.id=`${i=i||"ABCL"}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,this.message=e,this.onAccept=t,this.onDeny=n,this.show(),-1!==s&&setTimeout((()=>{this.prompt.remove()}),s)}show(){this.prompt.classList.add("ABCLPrompt"),this.prompt.id=this.id,this.prompt.innerHTML=`<p>${this.message}</p><button class="ABCLPromptNo ABCLButton">Deny</button><button class="ABCLPromptYes ABCLButton">Accept</button>`,on.appendChild(this.prompt),this.prompt.querySelector(`#${this.id} .ABCLPromptYes`)?.addEventListener("click",(()=>{this.onAccept(),this.prompt.remove()})),this.prompt.querySelector(`#${this.id} .ABCLPromptNo`)?.addEventListener("click",(()=>{this.onDeny(),this.prompt.remove()}))}}const on=document.createElement("div");let an;on.classList.add("ABCLOverlay");const rn=()=>{const e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.0/cdn/themes/light.css",document.head.appendChild(e);const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.0/cdn/shoelace-autoloader.js",t.type="module",t.async=!0,document.head.appendChild(t);const n=document.createElement("style");n.innerHTML=(()=>{const e=Yt("color-primary","--tmd-accent",Ht("#0284c7"))+Yt("color-neutral","--tmd-element",Ht("#52525b")),t=[{className:"SoilinessPercentage",primary:"#d1aa98ff",secondary:"#ab674aff"},{className:"WetnessPercentage",primary:"#f3e1aeff",secondary:"#e7c463ff"},{className:"BowelFullness",primary:"#b7795cff",secondary:"#7c4c36ff"},{className:"BladderFullness",primary:"#eacd73ff",secondary:"#cba01eff"},{className:"Incontinence",primary:"#eeacacff",secondary:"#cb5b5bff"},{className:"MentalRegression",primary:"#e6bff1ff",secondary:"#ad74beff"}];let n="";for(const e of t)n+=`\n  .ABCL${e.className} {\n    margin-bottom: 10px;\n    margin-top: 3px;\n  }\n\t.ABCL${e.className}::part(base) {\n\t\tbackground-color: ${e.primary};\n\t}\n  .ABCL${e.className}::part(indicator) {\n    background-color: ${e.secondary};\n  }`;return`\n#ABCLCurrentPlayerSelect {\n  margin-bottom: 5px;\n}\n\n.ABCLOverlay {\n\taspect-ratio: 2/1;\n\tmax-width: 100%;\n\tmax-height: 100%;\n\tmargin: auto;\n\tposition: relative;\n\ttransform: translateY(-50%);\n\ttop: 50%;\n\tpointer-events: none;\n  font-family: arial;\n  color: var(--tmd-text, --sl-color-neutral-700);\n  order: 100;\n  z-index: 10000;\n}\n.ABCLWindowHeaderTitle {\n  margin: 5px;\n  font-size: 32px;\n  font-weight: bold;\n}\n\n.ABCLOpenStatsButton {\n  position: fixed;\n  bottom: 10px;\n  right: 10px;\n  z-index: 1000;\n  aspect-ratio: 1/1;\n  width: 4%;\n  white-space: collapse;\n  text-align: center;\n  border-radius: 5px;\n  background: #ffffffa6;\n  border: #e3e3e3 1px solid;\n  backdrop-filter: blur(4px);\n  pointer-events: all;\n  font-size: clamp(9px, 1.3vw, 43px);\n  cursor: pointer;\n}\n.ABCLOpenStatsButton:hover {\n  background: #ffffffd1;\n}\n.ABCLWindowClose {\n  aspect-ratio: 1/1;\n  background: transparent;\n  height: 29px;\n  border-radius: 0px 4px 0 0;\n  position: absolute;\n  right: 0px;\n  top: 0px;\n  border: none;\n  border-left: 1px #0000003d solid;\n}\n.ABCLWindowMinimize {\n  aspect-ratio: 1/1;\n  background: transparent;\n  height: 29px;\n  border-radius: 0px 0px 0 0;\n  position: absolute;\n  right: 30px;\n  top: 0px;\n  border: none;\n  border-left: 1px #0000003d solid;\n}\n.ABCLWindowHeader {\n  width: 100%;\n  display: grid;\n  grid-template-columns: 1fr 29px 24px;\n  margin: -6px;\n  padding: 5px;\n  border: 1px #0000003d solid;\n  border-radius: 6px 6px 0 0;\n}\n.ABCLNotification {\n\tbackground-color: white;\n\twidth: fit-content;\n\ttext-align: center;\n\tmargin: auto;\n\tz-index: 10000;\n\tposition: absolute;\n\tbottom: 30px;\n\tleft: 25%;\n\ttransform: translateX(-50%);\n\tborder: 1px solid black;\n\tdisplay: grid;\n\tgrid-template-columns: 30px 1fr;\n\tpadding: 5px;\n\tpointer-events: all;\n}\n\n.ABCLPrompt {\n  background: white;\n  width: fit-content;\n  padding: 6px;\n  border: 1px solid black;\n  text-align: center;\n  position: absolute;\n  top: 50%;\n  left: 25%;\n  transform: translate(-50%, -50%);\n\tpointer-events: all;\n}\n.ABCLButton {\n  border: 1px #020202 solid;\n  padding: 3px;\n  margin: 4px;\n  aspect-ratio: 3/2;\n  width: 38px;\n  cursor: pointer;\n}\n.ABCLPromptYes {\n  background: #5ae85a;\n  color: black;\n}\n.ABCLPromptNo {\n  background: #ff4b4b;\n  color: white;\n}\n\n.ABCLClose:hover {\n  background: #ff4b4b;\n  color: white;\n  cursor: pointer;\n}\n\n.ABCLStatsWindow {\n  width: 200px;\n  height: fit-content;\n  padding: 5px;\n  background: #ffffffa6;\n  border: #e3e3e3 1px solid;\n  pointer-events: all;\n  position: fixed;\n  backdrop-filter: blur(4px);\n  border-radius: 6px;\n  box-shadow: 0 4px 5px 1px #00000014;\n}\n\n.ABCLSettingPage {\n  width: 81%;\n  margin: 6% auto;\n  pointer-events: all;\n}\n.ABCLAddCaregiver {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  width: 25rem;\n}\n.ABCLAddCaregiverButton {\n  margin-left: 5px;\n}\n.ABCLAddCaregiverInput {\n  margin-right: 5px;\n  flex: 1;\n}\n.ABCLCaregiverLabel {\n  margin-top: 1em;\n  display: block;\n}\n.ABCLCaregiverList {\n  list-style: none;\n  border: solid var(--sl-input-border-width) var(--sl-input-border-color);\n  border-radius: var(--sl-input-border-radius-medium);\n  padding: 0rem 0rem;\n  width: fit-content;\n  min-width: 17em;\n  max-height: 15em;\n  overflow-y: scroll;\n  font-size: var(--sl-button-font-size-medium);\n  line-height: calc(var(--sl-input-height-medium) - var(--sl-input-border-width) * 2);\n}\n.ABCLCaregiver {\n  padding: 0.3rem;\n  border: solid var(--sl-input-border-width) var(--sl-input-border-color);\n  display: flex;\n}\n.ABCLRemoveCaregiver {\n  aspect-ratio: 1;\n  width: fit-content;\n  margin-left: 0.5em;\n}\n.ABCLCaregiverName {\n  flex: 1;\n}\n.ABCLRemoveCaregiver::part(base) {\n  background: #ff7b7b;\n  color: white;\n  font-weight: bold;\n}\n.ABCLSettingPage sl-checkbox {\n  display: block;\n  margin: 1rem 0;\n  width: fit-content;\n}\n.sl-theme-light, .sl-theme-dark {\n  --sl-toggle-size-small: 0.875rem;\n  --sl-toggle-size-medium: 1.125rem;\n  --sl-toggle-size-large: 1.375rem;\n\n  --sl-input-height-small: 1.875em;\n  --sl-input-height-medium: 2.5em;\n  --sl-input-height-large: 3.125em;\n\n  --sl-letter-spacing-loose: 0.075em;\n  --sl-letter-spacing-looser: 0.15em;\n\n  --sl-font-size-large: 1.25em;\n  --sl-font-size-x-large: 1.5em;\n  --sl-font-size-2x-large: 2.25em;\n  --sl-font-size-3x-large: 3em;\n  --sl-font-size-4x-large: 4.5em;\n  \n  --sl-spacing-3x-small: 0.125em;\n  --sl-spacing-2x-small: 0.25em;\n  --sl-spacing-x-small: 0.5em;\n  --sl-spacing-small: 0.75em;\n  --sl-spacing-medium: 1em;\n  --sl-spacing-large: 1.25em;\n  --sl-spacing-x-large: 1.75em;\n  --sl-spacing-2x-large: 2.25em;\n  --sl-spacing-3x-large: 3em;\n  --sl-spacing-4x-large: 4.5em;\n\n  --sl-border-radius-small: 0.1875em;\n  --sl-border-radius-medium: 0.25em;\n  --sl-border-radius-large: 0.5em;\n  --sl-border-radius-x-large: 1em;\n\n  --sl-font-size-2x-small: 1.2vmin;\n  --sl-font-size-x-small: 1.4vmin;\n  --sl-font-size-small: 1.6vmin;\n  --sl-font-size-medium: 1.6vmin;\n  --sl-font-size-large: 2.5vmin;\n  --sl-font-size-x-large: 3vmin;\n  --sl-font-size-2x-large: 4.5vmin;\n  --sl-font-size-3x-large: 6vmin;\n  --sl-font-size-4x-large: 9vmin;\n}\n.ABCLoverlay sl-tab,.ABCLoverlay sl-radio-button,.ABCLoverlay sl-checkbox {\n  pointer-events: all;\n}\n\n\n\n.ABCLMessageVisibility {\n  margin-top: 1em\n}\n\n${n}\n\n.ABCLHidden {\n  display: none !important;\n}\n:root, :host, .sl-theme-light, .sl-theme-dark {\n${e}\n}\n\n.ABCLoverlay sl-radio-button::part(button),\n  .ABCLoverlay sl-tab::part(base), \n  .ABCLoverlay sl-tab::part(base).tab {\n  background-color: var(--tmd-element,  var(--sl-color-neutral-0));\n  color: var(--tmd-text,  var(--sl-color-neutral-700));\n}\n.ABCLoverlay sl-radio-button::part(label) {\n  color: var(--tmd-text,  var(--sl-color-neutral-700));\n}\n.ABCLoverlay sl-tab::part(base) {\n  color: var(--tmd-text, --sl-color-neutral-700);\n  background-color: var(--tmd-element-hover,  var(--sl-color-neutral-0));\n}\n.ABCLoverlay sl-tab::part(base):hover {\n  color: var(--tmd-text, --sl-color-neutral-0);\n  background-color: var(--tmd-element-hover,  var(--sl-color-primary-600));\n}\n\nsl-radio-button::part(button), sl-tab::part(base) {\n  color: var(--tmd-text, --sl-color-neutral-700);\n  background-color: var(--tmd-element,  var(--sl-color-neutral-0));\n  \n}\nsl-tab::part(base) {\n  border-radius: 0;\n}\nsl-radio-button::part(button) {\n    border: var(--tmd-element,  var(--sl-color-neutral-200)) 1px solid;\n}\n\nsl-radio-button::part(button):hover, sl-tab::part(base):hover {\n  color: var(--tmd-text, --sl-color-neutral-0);\n  background-color: var(--tmd-element-hover,  var(--sl-color-primary-600));\n}\nsl-radio-button::part(button):hover {\n  border: var(--tmd-element-hover,  var(--sl-color-primary-600)) 1px solid;\n}\n\nsl-radio-button::part(button--checked), sl-tab[aria-selected="true"]::part(base) {\n  color: var(--tmd-text, --sl-color-neutral-0);\n  background-color: var(--tmd-accent,  var(--sl-color-primary-600));\n}\nsl-radio-button::part(button--checked):hover ,sl-tab[aria-selected="true"]::part(base):hover {\n  background-color: var(--tmd-accent-hover);\n}\n\nsl-button::part(base) {\n  background-color: var(--tmd-element,  var(--sl-color-neutral-0));\n  border-color: var(--tmd-accent,  var(--sl-color-primary-600));\n}\nsl-button::part(base):hover {\n   background-color: var(--tmd-element-hover,  var(--sl-color-primary-600));\n   border-color: var(--tmd-accent-hover,  var(--sl-color-primary-600));\n}\nsl-button::part(base):active {\n  background-color: var(--tmd-accent-hover,  var(--sl-color-primary-700));\n  border-color: var(--tmd-accent-hover,  var(--sl-color-primary-700));\n}\nsl-button::part(label) {\n  color: var(--tmd-text,  var(--sl-color-neutral-700));\n}\nsl-button::part(label) {\n  color: var(--tmd-text,  var(--sl-color-neutral-700));\n}\nsl-button {\n    margin: 0.5em 0;\n}\nsl-drawer::part(panel) {\n  background-color: var(--tmd-element,  var(--sl-color-neutral-0));\n}\nsl-checkbox::part(control--checked) {\n  border-color: var(--tmd-accent-hover,  var(--sl-color-primary-600));\n  background-color: var(--tmd-accent,  var(--sl-color-primary-600))\n}\nsl-tab-group sl-tab-panel[name="messages"]::part(base) {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n}\n/* sorry fusam */\n#fusam-addon-manager-container {\n  position: absolute;\n  top: 0;\n}\n`})(),document.head.appendChild(n),an=new tn,document.body.appendChild(on),Rt("#chat-room-div",{childCheck:!0,timeout:1e22}).then((()=>{Rt(".ABCLOverlay",{timeout:1e22}).then((()=>{document.removeChild(on),setTimeout((()=>{document.appendChild(on)}),1e3)}))}))},ln=()=>{CharacterRefresh(Player,!0),ChatRoomCharacterUpdate(Player)},cn={onAccident:()=>{cn.stats.MentalRegression+=Dn()??0},update:()=>{cn.stats.MentalRegression+=Bn()??0,cn.stats.BladderValue+=cn.stats.WaterIntake*Nt[cn.settings.PeeMetabolism],cn.stats.BowelValue+=cn.stats.FoodIntake*Nt[cn.settings.PoopMetabolism],"Disabled"!==cn.settings.PeeMetabolism&&cn.attemptWetting(),"Disabled"!==cn.settings.PoopMetabolism&&cn.attemptSoiling(),un.save()},wetClothing:()=>{if(Gt("You've had a wet accident in your clothes!"),cn.stats.PuddleSize+=cn.stats.BladderValue,cn.stats.BladderValue=0,gn()?en("%NAME%'s diaper leaks and wet %INTENSIVE% clothes causing a puddle to form.",void 0,"wetClothing"):en("%NAME%'s wets %INTENSIVE% clothes leaks onto the floor.",void 0,"wetClothing"),Zn(),cn.settings.DisableClothingStains)return;const e="#96936C",t=InventoryGet(Player,"Panties");if(t&&!hn(t)){const n=Vt(t.Color||t.Asset.DefaultColor,t.Asset);for(let t=0;t<n.length;t++)jt(n[t])&&(n[t]=fn(n[t],e,.3));t.Color=n}for(const t of Player.Appearance)if(St.ItemDefinitions.Pants.some((e=>e===t.Asset.Description))){const n=Vt(t.Color||t.Asset.DefaultColor,t.Asset);for(let t=0;t<n.length;t++)jt(n[t])&&(n[t]=fn(n[t],e,.3));t.Color=n}ln()},soilClothing:()=>{if(cn.stats.BowelValue=0,gn()?en("%NAME%'s diaper leaks and soils %INTENSIVE% clothes.",void 0,"soilClothing"):en("%NAME% soils %INTENSIVE% clothes.",void 0,"soilClothing"),Zn(),cn.settings.DisableClothingStains)return;const e="#261a16",t=InventoryGet(Player,"Panties");if(t&&!hn(t)){const n=Vt(t.Color||t.Asset.DefaultColor,t.Asset);for(let t=0;t<n.length;t++)jt(n[t])&&(n[t]=fn(n[t],e,.3));t.Color=n}for(const t of Player.Appearance)if(St.ItemDefinitions.Pants.some((e=>e===t.Asset.Description))){const n=Vt(t.Color||t.Asset.DefaultColor,t.Asset);for(let t=0;t<n.length;t++)jt(n[t])&&(n[t]=fn(n[t],e,.3));t.Color=n}ln()},wetDiaper:()=>{const e=Cn(),t=Math.min(cn.stats.BladderValue,Math.max(0,e-cn.stats.WetnessValue));en("%NAME% wets %INTENSIVE% diaper.",void 0,"wetDiaper"),cn.stats.BladderValue-=t,cn.stats.WetnessValue+=t,cn.stats.WetnessValue>=e&&cn.wetClothing()},soilDiaper:()=>{const e=Cn(),t=Math.min(cn.stats.BowelValue,Math.max(0,e-cn.stats.SoilinessValue));en("%NAME% soils %INTENSIVE% diaper.",void 0,"soilDiaper"),cn.stats.BowelValue-=t,cn.stats.SoilinessValue+=t,cn.stats.SoilinessValue>=e&&cn.soilClothing()},attemptWetting:()=>{const e=Sn(cn.stats.Incontinence),t=wn(cn.stats.Incontinence,cn.stats.BladderFullness);(Math.random()<t||cn.stats.BladderFullness>e)&&dn.check()&&MiniGameStart("WetMinigame",30*t,"noOp")},attemptSoiling:()=>{const e=Sn(cn.stats.Incontinence),t=wn(cn.stats.Incontinence,cn.stats.BowelFullness);(Math.random()<t||cn.stats.BowelFullness>e)&&dn.check()&&MiniGameStart("MessMinigame",30*t,"noOp")},wet:(e=!1)=>{const t=.3*cn.stats.Incontinence,n=cn.stats.BladderFullness<.3-t,s=!n,i=cn.stats.BladderFullness>.6-t;n&&e?Gt("You try to pee, but it doesn't seem to be working."):(s&&(gn()?cn.wetDiaper():cn.wetClothing()),i&&e?cn.stats.Incontinence-=Ln(cn.stats.Incontinence):cn.stats.Incontinence+=Ln(cn.stats.Incontinence))},soil:(e=!1)=>{const t=.3*cn.stats.Incontinence,n=cn.stats.BowelFullness<.3-t,s=!n,i=cn.stats.BowelFullness>.6-t;n&&e?Gt("You try to let go, but nothing seems to happen."):(s&&(gn()?cn.soilDiaper():cn.soilClothing()),i&&e?cn.stats.Incontinence-=.01:cn.stats.Incontinence+=.02)},stats:{set PuddleSize(e){e<0&&(e=0),e>250&&(e=250);const t=e-Player.ABCL.Stats.PuddleSize.value;Qt("PuddleSize",t),Player.ABCL.Stats.PuddleSize.value=e},get PuddleSize(){return Player.ABCL.Stats.PuddleSize.value},set MentalRegression(e){e<0&&(e=0),e>1&&(e=1);const t=e-Player.ABCL.Stats.MentalRegression.value;Qt("MentalRegression",t,!0),Player.ABCL.Stats.MentalRegression.value=e,an.update()},get MentalRegression(){return Player.ABCL.Stats.MentalRegression.value},set Incontinence(e){e<0&&(e=0),e>1&&(e=1);const t=e-Player.ABCL.Stats.Incontinence.value;Qt("Incontinence",t,!0),Player.ABCL.Stats.Incontinence.value=e,an.update()},get Incontinence(){return Player.ABCL.Stats.Incontinence.value},set WaterIntake(e){e<0&&(e=0),Player.ABCL.Stats.WaterIntake.value=e},get WaterIntake(){return Player.ABCL.Stats.WaterIntake.value},set FoodIntake(e){e<0&&(e=0),Player.ABCL.Stats.FoodIntake.value=e},get FoodIntake(){return Player.ABCL.Stats.FoodIntake.value},set BladderValue(e){e<0&&(e=0);const t=e/this.BladderSize-this.BladderFullness;Qt("Bladder",t,!0),Player.ABCL.Stats.Bladder.value=e,an.update()},get BladderValue(){return Player.ABCL.Stats.Bladder.value},set BladderSize(e){e<0&&(e=0),Player.ABCL.Stats.Bladder.size=e,an.update()},get BladderSize(){return Player.ABCL.Stats.Bladder.size},set WetnessValue(e){e<0&&(e=0);const t=e/Cn()-this.WetnessPercentage;Qt("Wetness",t,!0),Player.ABCL.Stats.Wetness.value=e,An(),an.update()},get WetnessValue(){return Player.ABCL.Stats.Wetness.value},set BladderFullness(e){e<0&&(e=0),this.BladderValue=e*this.BladderSize,an.update()},get BladderFullness(){return this.BladderValue/this.BladderSize},set BowelValue(e){e<0&&(e=0);const t=e/this.BowelSize-this.BowelFullness;Qt("Bowel",t,!0),Player.ABCL.Stats.Bowel.value=e,an.update()},get BowelValue(){return Player.ABCL.Stats.Bowel.value},set BowelSize(e){e<0&&(e=0),Player.ABCL.Stats.Bowel.size=e,an.update()},get BowelSize(){return Player.ABCL.Stats.Bowel.size},set SoilinessValue(e){e<0&&(e=0);const t=e/Cn()-this.SoilinessPercentage;Qt("Soiliness",t,!0),Player.ABCL.Stats.Soiliness.value=e,An(),an.update()},get SoilinessValue(){return Player.ABCL.Stats.Soiliness.value},set BowelFullness(e){e<0&&(e=0),this.BowelValue=e*this.BowelSize,an.update()},get BowelFullness(){return this.BowelValue/this.BowelSize},get SoilinessPercentage(){return 0==Cn()?0:this.SoilinessValue/Cn()},set SoilinessPercentage(e){e<0&&(e=0),this.SoilinessValue=e*Cn()},get WetnessPercentage(){return 0==Cn()?0:this.WetnessValue/Cn()},set WetnessPercentage(e){e<0&&(e=0),this.WetnessValue=e*Cn()}},settings:{get AccidentsByActivities(){return Player.ABCL.Settings.AccidentsByActivities},set AccidentsByActivities(e){Player.ABCL.Settings.AccidentsByActivities=e},set DisableClothingStains(e){Player.ABCL.Settings.DisableClothingStains=e},set DisableDiaperStains(e){Player.ABCL.Settings.DisableDiaperStains=e},get DisableClothingStains(){return Player.ABCL.Settings.DisableClothingStains},get DisableDiaperStains(){return Player.ABCL.Settings.DisableDiaperStains},getStatusMessageSetting:e=>Player.ABCL.Settings.StatusMessages[e],setStatusMessageSetting(e,t){Player.ABCL.Settings.StatusMessages[e]=t},setPublicMessage(e,t){Player.ABCL.Settings.VisibleMessages[e]=t},getPublicMessage:e=>Player.ABCL.Settings.VisibleMessages[e],set PeeMetabolism(e){Player.ABCL.Settings.PeeMetabolism=e},set PoopMetabolism(e){Player.ABCL.Settings.PoopMetabolism=e},get PeeMetabolism(){return Player.ABCL.Settings.PeeMetabolism},get PoopMetabolism(){return Player.ABCL.Settings.PoopMetabolism},get OnDiaperChange(){return Player.ABCL.Settings.OnDiaperChange},set OnDiaperChange(e){Player.ABCL.Settings.OnDiaperChange=e},set OpenRemoteSettings(e){Player.ABCL.Settings.OpenRemoteSettings=e},get OpenRemoteSettings(){return Player.ABCL.Settings.OpenRemoteSettings}}},un=new class{constructor(e){this.lastSaveTime=0,this.allowedSaveInterval=e}save(){Date.now()-this.lastSaveTime>this.allowedSaveInterval&&($t(),this.lastSaveTime=Date.now())}}(12e4),dn=new class{constructor(e){this.lastCallTime=0,this.allowedCallInterval=e}check(){return Date.now()-this.lastCallTime>this.allowedCallInterval&&(this.lastCallTime=Date.now(),!0)}reset(){this.lastCallTime=0}isReady(){return Date.now()-this.lastCallTime>this.allowedCallInterval}}(12e4);window.abclPlayer=cn;const mn=(e="any")=>{const t=Cn();return"pee"===e?cn.stats.PuddleSize>0:"poop"===e?cn.stats.SoilinessValue>=t:cn.stats.SoilinessValue>=t||cn.stats.WetnessValue>=t},pn=()=>{const e=Cn();return cn.stats.SoilinessValue+cn.stats.WetnessValue>=e/2},hn=e=>e.Asset.Description.toLowerCase().includes("diaper")&&e.Asset.Description in St.Diapers;function gn(e=Player){if(!e)return!1;const t=InventoryGet(e,"ItemPelvis"),n=InventoryGet(e,"Panties");return Boolean(t&&hn(t)||n&&hn(n))}function fn(e,t,n=.5){let s=DrawHexToRGB(e),i=DrawHexToRGB(t),o={r:Math.round(s.r*n+i.r*(1-n)),g:Math.round(s.g*n+i.g*(1-n)),b:Math.round(s.b*n+i.b*(1-n))};return DrawRGBToHex([o.r,o.g,o.b])}function bn(e,t,n,s){return e>.75?e>.9?t:fn(t,n,e-.75):fn(n,s,e)}const vn=(e=Player)=>{if(!gn())return!1;const t=InventoryGet(e,"ItemPelvis");return Boolean(t&&hn(t)&&(Player.MemberNumber===e.MemberNumber?t.Property?.LockedBy:!(t.Property?.LockMemberNumber===e.MemberNumber||"ExclusivePadlock"===t.Property?.LockedBy)))},yn=(e,t,n=Player)=>{if(cn.settings.DisableDiaperStains)return;const s=InventoryGet(n,e);if(s&&hn(s)){const e=s.Color&&"string"!=typeof s.Color?s.Color:s.Asset.DefaultColor,n=St.Diapers[s.Asset.Description],i=Math.min(cn.stats.SoilinessValue+cn.stats.WetnessValue/Cn(),1);if("indicator"in n)for(const t of n.indicator)e[t]=fn(St.DiaperColors.indicatorAccident,s.Asset.DefaultColor[t],i);if("gradients"in n)for(const o of n.gradients)s.Property?.Opacity&&"object"==typeof s.Property.Opacity&&(s.Property.Opacity[o]=i,e[o]=t);if("color"in n)for(const s of n.color)e[s]=t;console.log(e),s.Color=e}},An=()=>{const e=cn.stats.SoilinessValue/Cn(),t=cn.stats.WetnessValue/Cn(),n=bn(e,St.DiaperColors.maximummess,St.DiaperColors.middlemess,St.DiaperColors.clean),s=bn(t,St.DiaperColors.maximumwet,St.DiaperColors.middlewet,St.DiaperColors.clean),i=Math.max(Math.min((e+(1-t))/2,2),0),o=fn(n,s,i);console.log(i,o),yn("ItemPelvis",o,Player),yn("Panties",o,Player),ln()};function Cn(e=Player){const t=InventoryGet(e,"ItemPelvis"),n=InventoryGet(e,"Panties");let s=50;return t&&hn(t)&&(s+=Pn(t)),n&&hn(n)&&(s+=Pn(n)),s}function Pn(e){return"Poofy Chastity Diaper"===e.Asset.Description&&1===e.Property?.TypeRecord?.typed?St.DiaperSizeScale.heavy_adult:St.DiaperSizeScale[St.Diapers[e.Asset.Description].size]}const Sn=e=>.9-.5*e;function wn(e,t){const n=.6*Math.pow(e,2)+.8*Math.pow(t,3);return Math.min(Math.max(n,0),1)}const Mn=()=>{const e=Player.Appearance.map((e=>e.Asset.Description)),t=St.ItemDefinitions.BabyItems.concat(["milk","pacifier","bib"]).filter((t=>e.some((e=>e.toLocaleLowerCase().includes(t)))));return Math.min(.25*t.length,1)},Bn=function(e,t,n){var s=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return P(n)&&(s="leading"in n?!!n.leading:s,i="trailing"in n?!!n.trailing:i),gt(e,t,{leading:s,maxWait:t,trailing:i})}((()=>{let e=-.5+Mn();Player.Appearance.some((e=>St.ItemDefinitions.BabyItems.includes(e.Asset.Description)))&&(e+=1),pn()&&(e+=.25),mn()&&(e+=.5),e=Math.max(-1,Math.min(e,1));const t=cn.stats.MentalRegression;let n;if(e>0)n=1+Math.pow(15*t,2);else{if(!(e<0))return 0;n=1+Math.pow(15*(1-t),2)}return.1*e/n}),3e5),Ln=e=>{const t=[{increase:.01,start:0,end:.25},{increase:.005,start:.25,end:.5},{increase:.0025,start:.5,end:.75},{increase:.001,start:.75,end:1}];for(const{increase:n,start:s,end:i}of t)if(e>=s&&e<i)return n;return 0},Dn=()=>{const e=1+Mn();return cn.stats.MentalRegression<.25||.25>cn.stats.MentalRegression&&cn.stats.MentalRegression<.5&&pn()?e/500:.5>cn.stats.MentalRegression&&cn.stats.MentalRegression<.75&&mn()?e/1e3:.75>cn.stats.MentalRegression&&cn.stats.MentalRegression<1&&mn()?e/1500:0},kn=e=>{if(e.MemberNumber!==Player.MemberNumber)return Jn("changeDiaper-pending",void 0,e.MemberNumber);In(e)},In=e=>{en(Zt(e.MemberNumber===Player.MemberNumber?"%NAME% changes %INTENSIVE% diaper.":"%OPP_NAME% changes %NAME%'s diaper.",e),void 0,"changeDiaper",e),cn.stats.WetnessValue=0,cn.stats.SoilinessValue=0,An()},xn={activity:{ID:"change-diaper",Name:"Change Diaper",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/changeDiaper.svg",Target:["ItemPelvis"],OnClick:(e,t)=>kn(e),Criteria:e=>gn(e)&&Kt(e)&&!Player.IsRestrained()&&!vn()},command:{Tag:"change-diaper",Action:(e,t,n)=>{const s=Xt(n)??Player;if(!xn.activity.Criteria(s))return Gt("Is either not diapered or not an ABCL player or you are restrained or diaper is locked.");kn(s)},Description:" [MemberNumber|Name|Nickname]: Changes someone's diaper."},listeners:{"changeDiaper-accepted":({Sender:e})=>Gt(`${Jt(e)} accepted your change diaper request.`),"changeDiaper-rejected":({Sender:e})=>Gt(`${Jt(e)} rejected your change diaper request.`),"changeDiaper-pending":({Sender:e})=>{switch(cn.settings.OnDiaperChange){case It:new sn(`${Jt(e)} wants to change your diaper.`,(()=>{In(qt(e)??Player),Jn("changeDiaper-accepted",void 0,e)}),(()=>Jn("changeDiaper-rejected",void 0,e)),1e4);break;case xt:In(qt(e)??Player),Jn("changeDiaper-accepted",void 0,e);break;case kt:Jn("changeDiaper-rejected",void 0,e)}}}},Nn=e=>{const t=e.MemberNumber===Player.MemberNumber;if(an.open(e.MemberNumber),!(Math.random()<.75))return gn(e)?en(Zt(t?"%NAME% checks %INTENSIVE% diaper.":"%NAME% checks %OPP_NAME%'s diaper.",e),void 0,"checkDiaper",e):en(Zt(t?"%NAME% checks %INTENSIVE% clothes for any accidents.":"%NAME% checks %OPP_NAME%'s clothes for any accidents.",e),void 0,"checkDiaper",e)},Tn={activity:{ID:"check-diaper",Name:"Check Diaper",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/diaperCheck.png",OnClick:(e,t)=>Nn(e),Target:["ItemPelvis"],Criteria:e=>Kt(e)&&!Player.IsRestrained()},command:{Tag:"check-diaper",Description:" [MemberNumber|Name|Nickname]: Checks someone's diaper.",Action:(e,t,n)=>{const s=Xt(n)??Player;if(!Tn.activity.Criteria(s))return Gt("Is not an ABCL player or you are restrained.");Nn(s)}}},En=e=>{if(!(e.MemberNumber===Player.MemberNumber))return Jn("lick-puddle",void 0,e.MemberNumber);_n(Player)},_n=e=>{en(Zt(e.MemberNumber===Player.MemberNumber?"%NAME% licks %INTENSIVE% puddle of pee.":"%OPP_NAME% licks %NAME%'s puddle of pee.",e),void 0,"lickPuddle",e),Zn(),ln(),cn.stats.PuddleSize-=50},Fn={activity:{ID:"lick-puddle",Name:"Lick Puddle",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/lickPuddle.png",Target:["ItemBoots"],OnClick:(e,t)=>En(e),Criteria:e=>Kt(e)&&e.ABCL.Stats.PuddleSize.value>0},command:{Tag:"lick-puddle",Action:(e,t,n)=>{const s=Xt(n)??Player;if(!Fn.activity.Criteria(s))return Gt("Is either not an ABCL player or has no puddle.");En(s)},Description:" [MemberNumber|Name|Nickname]: Licks a puddle of pee."},listeners:{"lick-puddle":({Sender:e})=>_n(qt(e)??Player)}},$n={listeners:{onABCLMessage:({Sender:e},{message:t,local:n})=>{Gt(t,void 0,"background: #FFA9A93B",n)}}},On={listeners:{sync:({Sender:e},t)=>{if(!e)return;console.log("sync:ABCL"),n.debug({message:"Received updated data",data:t});const s=qt(e);s&&(s.ABCL={Stats:t.stats,Version:t.version,Settings:t.settings})},init:({Sender:e})=>{console.log("init"),n.debug("Received request for data"),Zn(e)}}},zn={activity:{ID:"pee",Name:"Pee",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/wetDiaper.svg",OnClick:(e,t)=>cn.wet(!0),TargetSelf:["ItemPelvis"]},command:{Tag:"pee",Action:(e,t,n)=>cn.wet(!0),Description:" Lets go of your bladder."}},Gn={activity:{ID:"poop",Name:"Poop",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/soilDiaper.svg",OnClick:(e,t)=>cn.soil(!0),TargetSelf:["ItemPelvis"]},command:{Tag:"poop",Action:()=>cn.soil(!0),Description:" Relaxes your bowels."}},Rn=()=>{const e=.3*cn.stats.Incontinence,t=cn.stats.BladderFullness>.6||cn.stats.BowelFullness>.6,n=cn.stats.BladderFullness<.3-e&&cn.stats.BowelFullness<.3-e,s=cn.stats.MentalRegression>.9,i=cn.stats.MentalRegression<.3;if(n)return void en("%NAME% tries to use the potty but can't seem to get anything out.",void 0,"usePotty");cn.stats.BowelFullness=0,cn.stats.BladderFullness=0;let o="";i&&(o="and feels embarrased",cn.stats.MentalRegression+=.04),t&&!s&&(o+=i?" but is releaved":"and feels releaved",cn.stats.Incontinence+=-.01,cn.stats.MentalRegression-=.02),en("%NAME% sits down uses the potty "+o+".",void 0,"usePotty")},jn={activity:{ID:"potty",Name:"Sit and Use Potty",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/potty-temp.png",OnClick:e=>Rn(),TargetSelf:["ItemButt"],Criteria:e=>!(gn(e)&&vn()||Player.IsRestrained())},command:{Tag:"use-potty",Action:(e,t,n)=>{if(!jn.activity?.Criteria(Player))return Gt("You are restrained or diaper is locked.");Rn()},Description:" Sit down and use the potty."}},Vn=()=>{const e=.3*cn.stats.Incontinence,t=cn.stats.BladderFullness<.3&&cn.stats.BowelFullness<.3,n=cn.stats.BladderFullness>.6-e||cn.stats.BowelFullness>.6-e;if(t)return Gt("You try to use the toilet but you can't seem to get anything out.");let s="";n&&(s="and feels releaved",cn.stats.MentalRegression-=.02,cn.stats.Incontinence+=-.01),cn.stats.BladderFullness=0,cn.stats.BowelFullness=0,en("%NAME% goes to the bathroom uses the toilet "+s+".",void 0,"useToilet")},Wn={activity:{ID:"toilet",Name:"Sit and Use Toilet",Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/activity/toilet-temp.png",OnClick:e=>Vn(),Criteria:e=>cn.stats.MentalRegression<.3&&!(gn(e)&&vn())&&!Player.IsRestrained(),TargetSelf:["ItemButt"]},command:{Tag:"use-toilet",Action:()=>cn.stats.MentalRegression<.3?Gt("You feel uncomfortable, the toilet is cold and hard almost like ice. You can't use it."):gn()&&(Player.IsRestrained()||vn())?Gt("You can't use the toilet while your diaper is locked."):void Vn(),Description:" Sit down and use the toilet."}},Hn=e=>{if(e.MemberNumber!==Player.MemberNumber)return Jn("wipe-puddle",void 0,e.MemberNumber);Un(Player)},Un=e=>{if(cn.stats.PuddleSize=0,Zn(),ln(),e.MemberNumber!==Player.MemberNumber)return en(Zt("%OPP_NAME% wipes %NAME%'s puddle of pee.",e),void 0,"wipePuddle",e);en(Zt("%NAME% wipes %INTENSIVE% puddle of pee.",e),void 0,"wipePuddle",e)},Yn={activity:{ID:"wipe-puddle",Name:"Wipe Puddle",Image:"./Assets/Female3DCG/ItemHandheld/Preview/Towel.png",Target:["ItemBoots"],OnClick:(e,t)=>Hn(e),Criteria:e=>Kt(e)&&e.ABCL.Stats.PuddleSize.value>0&&!Player.IsRestrained()},command:{Tag:"wipe-puddle",Action:(e,t,n)=>{const s=qt(n[0])??Player;if(!Yn.activity.Criteria(s))return Gt("Is either not an ABCL player or has no puddle. Or you are restrained.");Hn(s)},Description:" [MemberNumber|Name|Nickname]: Wipes a puddle of pee."},listeners:{"wipe-puddle":({Sender:e})=>{Un(qt(e)??Player)}}};class qn{constructor(e,t,n,s,i,o,a){this.id=e,this.name=t,this.image=n,this.onClick=s,this.target=i,this.targetSelf=o,this.criteria=a}fitsCriteria(e,t){return Boolean((!this.criteria||this.criteria(e))&&(this.target?.includes(t)||this.targetSelf?.includes(t)&&Player.MemberNumber===e?.MemberNumber))}createButton(){const e=document.createElement("button");return e.id=this.id,e.name=`ABCL_${this.name}`,e.dataset.group="ItemArms",e.className="blank-button button button-styling HideOnPopup dialog-grid-button",e.innerHTML=`<img decoding="async" loading="lazy" src="${this.image}" class="button-image"><span class="button-label button-label-bottom">${this.name}</span>`,e.addEventListener("click",(e=>{const t=CurrentCharacter?.FocusGroup?CurrentCharacter:Player,n=t?.FocusGroup?.Name;this.onClick&&n&&(this.onClick(t,n),DialogLeave())})),e}static isInserted(e){return Boolean(document.getElementById(e))}}const Xn=[xn,Tn,zn,Gn,jn,Wn,On,Fn,Yn,$n],Kn=Xn.reduce(((e,{command:t})=>t?[...e,t]:e),[]);Xn.reduce(((e,{activity:t})=>t?[...e,t]:e),[]);const Jn=(e,t,n)=>{const s={Type:"Hidden",Content:`${Lt}Msg`,Sender:Player.MemberNumber,Target:n,Dictionary:[{type:e,data:t}]};ServerSend("ChatRoomChat",s),console.log("sendDataToAction",e,t,n)},Zn=e=>{console.log("sendUpdateMyData target",e),Jn("sync",{settings:Player[Lt].Settings,stats:Player[Lt].Stats,version:Mt},e),n.debug({message:`Sending updated data to ${e??"everyone"}`})},Qn=()=>{Jn("init",1),n.debug("Requesting data from others.")},es=async()=>{await async function(e,t=(()=>!1)){for(;!e();){if(t())return!1;await new Promise((e=>setTimeout(e,10)))}return!0}((()=>ServerSocket&&ServerIsConnected)),Ot.hookFunction("DrawCharacter",1,((e,t)=>{const[n,s,i,o]=e;if(Kt(n)&&n.ABCL.Stats.PuddleSize.value>0){const e=n.ABCL.Stats.PuddleSize.value/300,t=512*e,a=235*e;DrawImageResize("https://zoe-64.github.io/ABCL/versions/beta/assets/puddle.png",s+(250*o-t/2),i+(940*o-a/2),t,a)}return t(e)})),Ot.hookFunction("ChatRoomSync",1,((e,t)=>(Zn(),t(e)))),Ot.hookFunction("ChatRoomMessage",1,((e,t)=>{if("ServerEnter"!==e[0].Content||e[0].Sender!==Player.MemberNumber)return(e=>{if("ABCLMsg"!==e?.Content)return;if(!e.Sender||!e.Dictionary)return;if(e.Sender===Player.MemberNumber)return;if("Hidden"!==e.Type)return;if(!e.Dictionary[0]?.type)return;const t=e.Dictionary[0]?.type,n=e.Dictionary[0]?.data;for(const s of Xn){const i=s.listeners?.[t];i&&i(e,n)}console.log("receivePacket",t,n,e.Sender)})(e[0]),t(e);Qn()})),Ot.hookFunction("CharacterAppearanceSetItem",1,((e,t)=>{let[n,s,i]=e;const o=t(e);return"ItemPelvis"===s&&i&&hn({Asset:i})&&An(),o})),Ot.hookFunction("ActivityRun",1,((e,t)=>{const n=t(e),[s,i,o,a,...r]=e,l=a?.Activity;if(cn.settings.AccidentsByActivities&&i.MemberNumber===Player.MemberNumber&&l.Name in wt){const e=wt[l.Name];"Disabled"!==cn.settings.PeeMetabolism&&e.wetting&&Math.random()<e.wetting*(1+2*cn.stats.Incontinence)&&cn.attemptWetting(),"Disabled"!==cn.settings.PoopMetabolism&&e.messing&&Math.random()<e.messing*(1+2*cn.stats.Incontinence)&&cn.attemptSoiling()}return n})),Ot.hookFunction("PreferenceSubscreenChatClick",1,((e,t)=>{if(MouseIn(1815,75,90,90)){const e=Player.ChatSettings?.ColorTheme??"Light";e.startsWith("Light")&&on&&!on.classList.contains("sl-theme-light")&&(on.classList.remove("sl-theme-dark"),on.classList.add("sl-theme-light"),on.style.color="black",n.info("SL theme switching: Light")),e.startsWith("Dark")&&on&&!on.classList.contains("sl-theme-dark")&&(on.classList.remove("sl-theme-light"),on.classList.add("sl-theme-dark"),on.style.color="white",n.info("SL theme switching: Dark"))}return t(e)}))},ts=[];window.addEventListener("error",(async e=>{if(console.error(e.filename),!e.filename.toLowerCase().includes("abcl"))return;const n=`${e.message} at ${e.filename} ${e.lineno}`;if(ts.includes(n))return;ts.push(n);const s={username:`${Player.Name} ${""===Player.Nickname?"":`aka ${Player.Nickname}`} (${Player.MemberNumber})`,thread_name:`${Lt} ${Mt} Error ${e.message}`.slice(0,100),content:`\n    error: ${n}\n\`\`\`\n${e.error.stack}\n\`\`\`\nmods: ${t.getModsInfo().map((e=>e.name)).join(", ")}`};await fetch("https://discord.com/api/webhooks/1340000414506029162/aqt7qruFnzDMM5BN_kLtv9gCcallIF-JeRVYl9k23uSIlxrHRvcFMy5mtPUPGDpWZhHX",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})}));const ns=document.createElement("div");ns.classList.add("ABCLSettingPage","ABCLHidden");Ot.hookFunction("TextLoad",5,((e,t)=>"WetMinigame"===CurrentScreen||"MessMinigame"===CurrentScreen?void 0:t(e)));function ss(e){var t=e.name;console.log("Registering minigame: "+t),window[t+"Run"]=()=>e.Run(),window[t+"Click"]=()=>e.Click(),window[t+"Load"]=()=>e.Load(),window[t+"Unload"]=()=>e.Unload(),window[t+"Resize"]=()=>e.Resize(),window[t+"KeyDown"]=()=>e.KeyDown(),window[t+"Exit"]=()=>e.Exit(),window[t+"End"]=t=>e.End(t)}class is{constructor(){this.name=""}Load(){}Unload(){}Resize(){}KeyDown(){}Exit(){}End(e){}}class os extends is{constructor(){super(...arguments),this.startText="",this.hintText="",this.failText="",this.successText="",this.tintColor=[{r:0,g:0,b:0,a:0}],this.GameStartTime=0,this.GameEndTime=0,this.StartDelay=4e3,this.AccidentVelocity=0,this.AccidentPosition=0,this.AccidentAcceleration=0,this.AccidentMaxPosition=100,this.AccidentGameDuration=5e3,this.AccidentNextTick=0,this.AccidentText="",this.AccidentChallenge=0,this.BaseGameLength=6e3}End(e){CommonSetScreen("Online","ChatRoom"),MiniGameVictory=e,MiniGameEnded=!0,MiniGameTimer=CommonTime(),this.GameEndTime=MiniGameTimer}get IsStartDelay(){return CommonTime()<this.GameStartTime}Load(){if(DrawFlashScreen("#000000",750,1e3),this.GameStartTime=CommonTime()+this.StartDelay,this.AccidentVelocity=0,this.AccidentAcceleration=0,"number"!=typeof MiniGameDifficulty)MiniGameTimer=CommonTime()+this.BaseGameLength,this.AccidentChallenge=5;else{var e=.25*(MiniGameDifficulty-8);this.AccidentGameDuration=this.BaseGameLength+1e3*e,MiniGameTimer=this.GameStartTime+this.AccidentGameDuration,this.AccidentChallenge=MiniGameDifficulty}this.AccidentMaxPosition=400,this.AccidentPosition=this.AccidentMaxPosition,console.info("Accident minigame started: difficulty - "+this.AccidentChallenge+" time - "+this.AccidentGameDuration)}get IsGameActive(){return CommonTime()<MiniGameTimer&&!MiniGameEnded&&!this.GameFailed}get IsGameTimeout(){return CommonTime()>=MiniGameTimer&&!MiniGameEnded}get IsEndGameReport(){return CommonTime()<this.GameEndTime+5e3}get GameFailed(){return this.AccidentPosition<=0}RunGame(e){var t=(this.AccidentGameDuration+CommonTime()-MiniGameTimer)/1e3;CommonTime()>this.AccidentNextTick&&(this.AccidentNextTick=CommonTime()+400,this.AccidentAcceleration=-1.25*this.AccidentChallenge-t*Math.random()),this.AccidentVelocity=Math.min(this.AccidentVelocity,this.AccidentVelocity+.25*this.AccidentAcceleration),this.AccidentPosition>=this.AccidentMaxPosition&&(this.AccidentVelocity=Math.min(0,this.AccidentVelocity)),this.AccidentPosition>0&&(this.AccidentPosition+=this.AccidentVelocity/1e3*e*3.5),this.AccidentPosition=Math.max(0,Math.min(this.AccidentPosition,this.AccidentMaxPosition)),DrawProgressBar(500-this.AccidentMaxPosition,800,2*this.AccidentMaxPosition,50,this.AccidentPosition/this.AccidentMaxPosition*100),DrawText(this.hintText,500,875,"white","black")}Run(){ChatRoomRun(CommonTime()),this.IsStartDelay?DrawText(this.startText,500,500,"white","black"):this.IsGameActive?this.RunGame(TimerRunInterval):!this.IsGameTimeout&&!this.GameFailed||MiniGameEnded||(this.End(this.AccidentPosition>0),MiniGameEnd())}Click(){var e;this.IsGameActive&&(this.AccidentVelocity=Math.max(this.AccidentVelocity+(e=11,Math.floor(Math.random()*e)+5),20))}}class as extends os{constructor(){super(...arguments),this.startText="A sudden pressure builds within you...",this.hintText="Click to maintain control. Keep it together!",this.failText="Oops! You've had an accident!",this.successText="Crisis averted! You stayed composed!",this.name="MessMinigame"}End(e){if(super.End(e),e)return cn.stats.Incontinence-=Ln(cn.stats.Incontinence)/2,void Gt("You managed to keep it together!");cn.soil(),cn.onAccident()}}class rs extends os{constructor(){super(...arguments),this.startText="You feel a trickle starting...",this.hintText="Click to squeeze tight. Don't let it get away!",this.failText="Oh no! You lost control!",this.successText="You held it in! Phew!",this.name="WetMinigame"}End(e){if(super.End(e),e)return cn.stats.Incontinence-=Ln(cn.stats.Incontinence)/2,void Gt("You managed to hold it in!");cn.wet(),cn.onAccident()}}window.clearData=()=>{Player.ExtensionSettings.ABCL="N4XyA===",ServerPlayerExtensionSettingsSync("ABCL"),n.warn("cleared data")},window.saveData=$t,window.mutateData=e=>{Player.ABCL=Pt(Player.ABCL||Ft,e),$t()},window.updateDiaperColor=An,window.noOp=()=>{},window.sendChatLocal=Gt,window.averageColor=fn;let ls,cs=class{constructor(e){this.hookMng=e,this.workList=[]}run(e,t){let n,s=!1;for(const i of this.workList)if("inject"===i.value)i.work(e,t);else if("next"===i.value)n=t(e),s=!0;else if("override"===i.value)n=i.work(e,t),s=!0;else if("flag"===i.value){if(!i.flag)break;i.once&&(i.flag=!1)}else if("check"===i.value&&!i.work(e,t))break;return s?n:t(e)}next(){return this.workList.push({value:"next"}),this}inject(e){return this.workList.push({value:"inject",work:e}),this}inside(e,{once:t=!1,priority:n=1}={}){const s={value:"flag",flag:!1,once:t};return this.hookMng.hookFunction(e,n,((e,t)=>{s.flag=!0;const n=t(e);return s.flag=!1,n})),this.workList.push(s),this}when(e){return this.workList.push({value:"check",work:e}),this}override(e){return this.workList.push({value:"override",work:e}),this}},us=class{static info(e){ls?.info(e)}static warn(e){ls?.warn(e)}static error(e){ls?.error(e)}},ds=class{constructor(e=!1){this.done=e,this.list=[]}run(){for(this.done=!0;this.list.length>0;)this.list.shift()()}push(e){this.done?e():this.list.push(e)}};const ms=new ds,ps=new ds,hs=new ds,gs=new ds;function fs(){return null!=globalThis.Player&&"number"==typeof globalThis.Player.MemberNumber}let bs;const vs=new class{get mod(){return bs}push(e,t){e.push(t)}init(e){bs=t.registerMod(e),gs.run(),ps.run();const n=()=>hs.run();fs()?n():this.mod.hookFunction("LoginResponse",0,((e,t)=>{t(e),fs()&&n()})),ms.run()}initWithMod(e){bs=e,gs.run(),ps.run();const t=()=>hs.run();fs()?t():this.mod.hookFunction("LoginResponse",0,((e,n)=>{n(e),fs()&&t()}))}afterInit(e){this.push(ms,e)}afterPlayerLogin(e){this.push(hs,e)}patchFunction(e,t){this.push(gs,(()=>this.mod.patchFunction(e,t)))}invokeOriginal(e,...t){return this.mod?this.mod.callOriginal(e,t):globalThis[e]?.(...t)}hookFunction(e,t,n){this.push(ps,(()=>this.mod.hookFunction(e,t,n)))}progressiveHook(e,t=1){const n=new cs(this);return this.hookFunction(e,t,((e,t)=>n.run(e,t))),n}hookPlayerFunction(e,t,n){var s;s=()=>this.mod.hookFunction(e,t,n),fs()?hs.push(s):s()}globalFunction(e,t){"function"!=typeof t&&us.warn("globalFunction: param is not a function"),null==globalThis[e]?globalThis[e]=t:globalThis[e]!=t&&us.warn(`globalFunction: ${e} is already defined`)}randomGlobalFunction(e,t){const n=e=>e+Math.random().toString(16).substring(2);let s=n(e);for(;null!=globalThis[s];)s=n(e);return globalThis[s]=t,s}setLogger(e){!function(e){ls=e}(e)}},ys=new Set(["ItemTorso","ItemTorso2"]),As={ItemTorso:ys,ItemTorso2:ys},Cs={},Ps={};function Ss(e){return(As[e]&&Array.from(As[e])||[e]).map((e=>ws(e)))}function ws(e){return{name:e,group:AssetGroupGet("Female3DCG",e)}}function Ms(e){return Cs[e]}class Bs{static add(e){for(const[t,n]of Object.entries(e))for(const[e,s]of Object.entries(n))Ss(t).forEach((({name:t})=>{AssetFemale3DCGExtended[t]||(AssetFemale3DCGExtended[t]={}),AssetFemale3DCGExtended[t][e]||(AssetFemale3DCGExtended[t][e]=s)}))}static get value(){return AssetFemale3DCGExtended}}const Ls={};class Ds{static add(e,t){return 0===Object.keys(Ls).length&&AssetFemale3DCG.forEach((e=>{Ls[e.Group]||(Ls[e.Group]={});for(const t of e.Asset){const n=ks(t);Ls[e.Group][n.Name]=n}})),Ls[e]||(Ls[e]={}),Ls[e][t.Name]=t,Ls}static get value(){return Ls}}function ks(e){return"string"==typeof e?{Name:e}:e}const Is={},xs={},Ns=(e,t)=>xs[e]?.[t];function Ts(){return xs}function Es(e){return!!(e&&e.Asset&&Ns(e.Asset.Group.Name,e.Asset.Name))}function _s(e,t){const n="TW"!==TranslationLanguage?TranslationLanguage:"CN";let s=e(n);return void 0!==s?s:(s="CN"===n?e("CN"):e("EN")||e("CN"),void 0!==s?s:t)}function Fs(e,t,n){return _s((n=>e[n]?.[t]),n)}function $s(e){return t=e,_s((e=>t[e]),e.CN);var t}function Os(e,t){return e?e.CN?e:{...e,CN:t}:{CN:t}}function zs(e,t,n){const s={};for(const[i,o]of Object.entries(n))o[e]?.[t]&&(s[i]=o[e][t]);return s}const Gs={},Rs={};class js{static setAsset(e,t,n){Object.entries(n).forEach((([n,s])=>{const i=n;Gs[i]||(Gs[i]={}),Gs[i][e]||(Gs[i][e]={}),Gs[i][e][t]=s}))}static setGroup(e,t){Object.entries(t).forEach((([t,n])=>{const s=t;Rs[s]||(Rs[s]={}),Rs[s][e]=n}))}}function Vs(e,t){e.Description=t}function Ws(){Object.values(Is).forEach((e=>Vs(e,function(e){return Fs(Rs,e,e.replace(/_.*?Luzi$/,""))}(e.Name)))),Object.values(Ts()).map((e=>Object.values(e))).flat().forEach((e=>Vs(e,function(e,t){return n=Gs,s=e,i=t,_s((e=>n[e]?.[s]?.[i]),t.replace(/_.*?Luzi$/,""));var n,s,i}(e.Group.Name,e.Name)))),Object.entries(Ts()).map((([e,t])=>({group:Ms(e),asset:t}))).filter((({group:e})=>!!e)).map((({group:e,asset:t})=>Object.entries(t).map((([t,n])=>({asset:n,fromAsset:AssetGet("Female3DCG",e,t)}))))).flat().filter((({fromAsset:e})=>!!e)).forEach((({asset:e,fromAsset:t})=>Vs(e,t.Description)));const e=TextAllScreenCache.get(AssetStringsPath),t=e=>{const t=Ps,n=new Set,s=AssetGroup.map((e=>e.Name)).sort(((e,t)=>t.length-e.length));Object.entries(e.cache).forEach((([i,o])=>{if(n.has(i))return;const a=s.find((e=>i.startsWith(e)));if(!a)return;n.add(i);const r=t[a];if(!r)return;const l=i.slice(a.length);r.forEach((t=>{const n=t+l;e.cache[n]||(e.cache[n]=o)}))}))};e&&(e.loaded?t(e):e.rebuildListeners.push((e=>e&&t(e))))}let Hs=!1;const Us=new Map;let Ys;function qs(e,t,n,s=!1){if(Ys?.()?.cache){const i=TranslationLanguage;if(Ys().cache[e]&&s)return;Ys().cache[e]=t[i]||t.CN||n}else{if(s&&Us.has(e))return;Us.set(e,{desc:t,fallback:n,noOverride:s})}}const Xs=e=>t=>Object.entries(e||{CN:{[t]:t}}).map((([e,n])=>[e,n[t]||e])).reduce(((e,[t,n])=>(e[t]=n,e)),{});function Ks(e,t,{entries:n,noOverride:s}={}){const i=Xs(n);t.Layer?.forEach((({Name:n})=>{n?qs(`${e}${t.Name}${n}`,i(n),n,!!s):qs(`${e}${t.Name}`,{CN:t.Name.replace(/_.*?Luzi$/,"")},t.Name,!!s)}))}let Js;class Zs{static info(e){Js?.info(e)}static warn(e){Js?.warn(e)}static error(e){Js?.error(e)}}let Qs=!1;const ei=[];function ti(e){Qs?e():ei.push(e)}const ni={},si={};function ii(e,t){const n=AssetGroupGet("Female3DCG",e);Qs&&n?t(n):(si[e]||(si[e]=[]),si[e].push(t))}let oi=!1;const ai=[];function ri(e){oi?e():ai.push(e)}const li=new Set;function ci(e,t,{extendedConfig:n,description:s,dynamicName:i,preimage:o,noMirror:a}={}){!function(e,t){const n=AssetGroupGet("Female3DCG",e);Qs&&n?t(n):(ni[e]||(ni[e]=[]),ni[e].push(t))}(e,(e=>{Ds.add(e.Name,t),n&&Bs.add(n)}));const r=e;!function(e,t,n){const s=n=>{const i=t?[ws(e)]:Ss(e),o=i.find((({group:e})=>!e));if(o)return li.has(o.name)?void console.error(`[AssetManager] Required group "${o.name}" not found`):(li.add(o.name),void ii(o.name,(()=>s(n))));i.forEach((({group:e})=>n(e)))};Qs?s(n):ii(e,(()=>s(n)))}(e,!!a,(e=>{const n=e.Name,a=ks(t),l=AssetResolveCopyConfig.AssetDefinition(a,n,Ds.value);if(!l)return;const c=Os(s,l.Name.replace(/_.*?Luzi$/,""));void 0!==Ts()[n]?.[a.Name]&&console.warn(`[AssetManager] Asset {${n}:${a.Name}} already existed!`),function(...[e,t,n]){vs.invokeOriginal("AssetAdd",e,t,n);const s=e.Name,i=t.Name;xs[s]||(xs[s]={});const o=AssetGet("Female3DCG",s,i);return o?(xs[s][i]=o,Promise.resolve(o)):Promise.reject(`Asset ${s}:${i} not found`)}(e,l,Bs.value).then((e=>{if(e.DynamicGroupName===e.Group.Name&&(e.DynamicGroupName=i||r),o){const t=AssetGet("Female3DCG",o.Name,l.Name);t&&(e.Description=t.Description,e.DynamicGroupName=t.DynamicGroupName,["ScriptDraw","BeforeDraw","AfterDraw"].filter((e=>t[`Dynamic${e}`])).forEach((e=>function(e,t,n,s){const i=`Assets${t}${n.Name}${s}`,o=`Assets${e}${n.Name}${s}`;globalThis[i]&&(globalThis[o]=globalThis[i])}(n,o.Name,l,e))))}else e.Description=$s(c),Ks(e.DynamicGroupName,l,{noOverride:!0})})),js.setAsset(n,l.Name,c)}))}const ui={};function di(e,{description:t,dynamicName:n,preimage:s}={}){ti((()=>{const i=Os(t,e.Group.replace(/_.*?Luzi$/,""));(function(...[e,t]){const n=vs.invokeOriginal("AssetGroupAdd",e,t);return Is[n.Name]=n,Promise.resolve(n)})("Female3DCG",e).then((t=>{t.Description=$s(i),n&&(t.DynamicGroupName=n),e.Asset.forEach((t=>{ci(e.Group,ks(t),{dynamicName:n,preimage:s})}))})),js.setGroup(e.Group,i)}))}const mi=new Set;function pi(e,t,n){const s=()=>{const i=AssetFemale3DCG.find((e=>e.Group===t)),o=AssetGroupGet("Female3DCG",t),a=AssetFemale3DCGExtended[t];if(!i||!o)return mi.has(t)?void console.error(`[AssetManager] Group ${t} not found`):(mi.add(t),void ti(s));var r,l;l=e,As[r=t]||(As[r]=new Set([r])),As[r].add(l),Ps[r]||(Ps[r]=new Set),Ps[r].add(l),Cs[l]=r;const c=Os(n,e.replace(/_.*?Luzi$/,""));di({...i,Group:e,Default:!1,Random:!1},{description:c,dynamicName:i.DynamicGroupName||i.Group,preimage:o}),AssetFemale3DCGExtended[e]=a};ti(s)}const hi={};let gi,fi=!1,bi=!1;function vi(e){return globalThis[e]}class yi{static _initStorage(){var e,t;vi(this._namespace)||(e=this._namespace,t={},globalThis[e]=t)}static get(e,t){this._initStorage();const n=vi(this._namespace);return e in n||(n[e]=t()),n[e]}static getMayOverride(e,t){this._initStorage();const n=vi(this._namespace);return n[e]=t(n[e]),n[e]}static set(e,t){this._initStorage(),vi(this._namespace)[e]=t}static has(e){return this._initStorage(),e in vi(this._namespace)}static delete(e){this._initStorage();const t=vi(this._namespace);return e in t&&delete t[e]}static setImplementation(e){const t=["get","set","has","delete"];for(const n of t){if("function"!=typeof e[n])throw new Error(`Implementation must provide a '${n}' function`);yi[n]=e[n]}}static createNamespace(e){return{get:(t,n)=>yi.get(`${e}.${t}`,n),set:(t,n)=>yi.set(`${e}.${t}`,n),has:t=>yi.has(`${e}.${t}`),delete:t=>yi.delete(`${e}.${t}`)}}}function Ai(e){return new Promise((t=>setTimeout(t,e)))}yi._namespace="__BC_LUZI_GLOBALS__",yi.createNamespace("OnceFlag");class Ci{static get emptyImage(){return"data:img/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAA\nG3RFWHRTb2Z0d2FyZQBDZWxzeXMgU3R1ZGlvIFRvb2zBp+F8AAAADUlEQVQI12P4//8/AwAI/AL+\nXJ/P2gAAAABJRU5ErkJggg=="}static assetPreviewIconPath(e){const t="Asset"in e?e.Asset:e;return`${AssetGetPreviewPath(t)}/${t.Name}.png`}static activityPreviewIconPath(e){return`Assets/Female3DCG/Activity/${("Activity"in e?e.Activity:e).Name}.png`}}const Pi=new class{constructor(){this.basic={},this.custom={}}addImgMapping(e){this.custom={...this.custom,...e}}setBasicImgMapping(e){this.basic={...e,...this.basic}}mapImgSrc(e){if("string"!=typeof e)return e;if(!e.endsWith(".png"))return e;if(e.startsWith("data:image"))return e;if(e.startsWith("http"))return e;const t=e.startsWith("./")?e.slice(2):e;let n=t;return this.custom[n]&&(n=this.custom[n]),this.basic[n]&&(n=this.basic[n]),n!==t?n:e}mapImg(e,t){let n=e;n.startsWith("data:image")||n.startsWith("http")||(this.custom[n]&&(n=this.custom[n]),this.basic[n]&&(n=this.basic[n]),n!==e&&t(n))}};class Si{constructor(){vs.patchFunction("GLDrawLoadImage",{"Img.src = url;":'Img.crossOrigin = "Anonymous";\n\t\tImg.src = url;'}),["DrawImageEx","DrawImageResize","GLDrawImage","DrawGetImage"].forEach((e=>{vs.hookFunction(e,0,((e,t)=>(e[0]=Pi.mapImgSrc(e[0]),t(e))))})),(async()=>{await function(e,t=100){return(async()=>{for(;!e();)await Ai(t)})()}((()=>void 0!==globalThis.ElementButton)),vs.hookFunction("ElementButton.CreateForAsset",0,((e,t)=>(Pi.mapImg(Ci.assetPreviewIconPath(e[1]),(t=>{e[4]={...e[4],image:t}})),t(e)))),vs.hookFunction("ElementButton.CreateForActivity",0,((e,t)=>{const n=e[1],s=n.Item?Ci.assetPreviewIconPath(n.Item.Asset):`Assets/Female3DCG/Activity/${n.Activity.Name}.png`;return Pi.mapImg(s,(t=>{e[4]={...e[4],image:t}})),t(e)}));const e=vs.randomGlobalFunction("mapImage",(e=>Pi.mapImgSrc(e)));vs.patchFunction("ElementButton._ParseIcons",{"src = `./Assets/Female3DCG/ItemMisc/Preview/${icon}.png`":`src = ${e}(\`./Assets/Female3DCG/ItemMisc/Preview/\${icon}.png\`)`})})()}addImgMapping(e){Pi.addImgMapping(e)}setBasicImgMapping(e){Pi.setBasicImgMapping(e)}}const wi=yi.get("ImageMapping",(()=>new Si)),Mi=new class{addAsset(e,t,n,s,i=!1){ci(e,t,{extendedConfig:n&&{[e]:{[t.Name]:n}},description:s,noMirror:i})}addGroupedAssets(e,t,n){for(const[s,i]of Object.entries(e))for(const e of i){const i=s,o=t&&zs(i,e.Name,t);ci(i,e,{extendedConfig:n&&n[i]?.[e.Name]&&{[i]:{[e.Name]:n[i][e.Name]}},description:o})}}addGroupedConfig(e){!function(e){e&&Bs.add(e)}(e)}modifyAsset(e,t,n){!function(e,t,n){const s=i=>{const o=AssetGet("Female3DCG",i.Name,t);if(o)n(i,o);else{if(ui[e]||(ui[e]=new Set),ui[e].has(t))return void console.error(`[AssetManager] Asset ${e}:${t} not found`);ui[e].add(t),ii(e,s)}};ii(e,s)}(e,t,n)}modifyAssetLayers(e,t){!function(e,t){ri((()=>{Asset.filter(e).forEach((e=>{e.Layer.forEach((n=>t(e,n)))}))}))}(e,t)}modifyGroup(e,t){!function(e,t){ii(e,(e=>t(e)))}(e,t)}addCustomDialog(e){!function(e){for(const[t,n]of Object.entries(e)){hi[t]||(hi[t]={});for(const[e,s]of Object.entries(n))hi[t][e]=s,e.includes("ItemTorso2")?hi[t][e.replace("ItemTorso2","ItemTorso")]=s:e.includes("ItemTorso")&&(hi[t][e.replace("ItemTorso","ItemTorso2")]=s)}}(e)}addImageMapping(e){wi.addImgMapping(e)}get imageMapping(){return wi}addGroup(e,t){di(e,{description:t})}addCopyGroup(e,t,n){pi(e,t,n)}addLayerNames(e,t,n){Ks(e,t,{entries:n})}addLayerNamesByEntry(e,t,n){!function(e,t,n,s=!0){const i=Xs(n);new Set(Object.entries(n).map((([e,t])=>Object.keys(t))).flat()).forEach((n=>{qs(`${e}${t}${n}`,i(n),n,!!s)}))}(e,t,n)}assetIsCustomed(e){return void 0!==Ts()[e.Group.Name]?.[e.Name]}afterLoad(e){ri(e)}init(e){!function(){if(fi)return;fi=!0;const e=e=>Fs(hi,e);vs.progressiveHook("AssetTextGet").override(((t,n)=>e(t[0])||n(t))),vs.progressiveHook("ChatRoomPublishCustomAction").inject((t=>{const[n,s,i]=t,o=e(n);o&&i.push({Tag:`MISSING TEXT IN "Interface.csv": ${n}`,Text:o})})).next()}(),function(){if(Hs)return;Hs=!0;const e=TextAllScreenCache.get(AssetStringsPath);e&&e.loaded&&("EN"===TranslationLanguage||"Bloated"!==e.get("Bloated"))?Ws():(vs.progressiveHook("AssetBuildDescription").next().inject(Ws),vs.progressiveHook("TranslationAssetProcess").next().inject(Ws));const t=vs.randomGlobalFunction("CustomDialogInject",((e,t,n,s,i)=>{for(const[t,n]of[["PrevAsset",s],["NextAsset",i]])Es(n)&&e.text(t,n.Asset.Description)}));vs.patchFunction("ChatRoomPublishAction",{"ChatRoomCharacterItemUpdate(C);":`${t}(dictionary, C, Action, PrevItem, NextItem);\nChatRoomCharacterItemUpdate(C);`})}(),function(){const e=vs.randomGlobalFunction("LayerNameInject",(e=>{Ys=e}));vs.patchFunction("ItemColorLoad",{"ItemColorLayerNames = new TextCache":`${e}(()=>ItemColorLayerNames);\nItemColorLayerNames = new TextCache`}),vs.progressiveHook("ItemColorLoad",1).next().inject((()=>{const e=Ys?.()?.cache;e&&Us.forEach(((e,t)=>{qs(t,e.desc,e.fallback,e.noOverride)}))}))}(),function(){let e=!1;vs.progressiveHook("DialogInventoryBuild").inject((t=>{t[2]||(e=!0)})),vs.progressiveHook("DialogInventoryAdd").next().inject((t=>{if(!e)return;e=!1;const n=t[1].Asset.Group.Name,s=new Set(DialogInventory.map((e=>e.Asset.Name)));xs[n]&&Object.entries(xs[n]).filter((([e,t])=>!t.NotVisibleOnScreen?.includes("LuziScreen")&&!s.has(e))).forEach((([e,n])=>DialogInventoryAdd(t[0],{Asset:n},!1)))}));const t=(...[e,t])=>{const[n,s,i]=e;return!!Ns(i,s)||t(e)};vs.progressiveHook("InventoryAvailable").inside("CharacterAppearanceValidate").override(t),vs.progressiveHook("InventoryAvailable").inside("CraftingItemListBuild").override(t),vs.progressiveHook("InventoryAvailable").inside("WardrobeFastLoad").override(t),vs.progressiveHook("CraftingValidate").inject((e=>{const t=e[0]?.Item;if(!t)return;const n=CraftingAssets[t]?.[0];n&&function(e,t){const n=Ns(e,t);return!!n&&!n.NotVisibleOnScreen?.includes("LuziScreen")}(n.Group.Name,n.Name)&&(e[3]=!1)}));const n=vs.randomGlobalFunction("CraftingInventory",(()=>[...Player.Inventory,...Object.values(xs).map((e=>Object.values(e))).flat().map((e=>({Asset:e})))]));vs.patchFunction("CraftingRun",{"for (let Item of Player.Inventory) {":`for (let Item of ${n}()) {`})}(),e(),function(e={start:"Start loading",end:"Loading completed, time usage: "}){const t=()=>{Zs.info(e.start);const t=Date.now();for(function(){for(;ei.length>0;)ei.shift()()}(),Qs=!0,AssetGroup.forEach((e=>function(e){if(ni[e.Name])for(;ni[e.Name].length>0;)ni[e.Name].shift()(e)}(e))),AssetGroup.forEach((e=>function(e){if(si[e.Name])for(;si[e.Name].length>0;)si[e.Name].shift()(e)}(e))),CraftingAssets=CraftingAssetsPopulate(),oi=!0;ai.length>0;)ai.shift()();const n=Date.now();Zs.info(`${e.end} ${n-t}ms`)};AssetGroup.length>50?t():vs.progressiveHook("AssetLoadAll",1).next().inject((()=>t()))}()}enableValidation(e){!function(e){gi=e,bi||(bi=!0,vs.hookFunction("ValidationResolveRemoveDiff",1,((e,t)=>{const[n,s]=e;return!s.fromModUser&&Ns(n.Asset.Group.Name,n.Asset.Name)?{item:n,valid:!1}:t(e)})),vs.hookFunction("ValidationResolveSwapDiff",1,((e,t)=>{const[n,s,i]=e;return!i.fromModUser&&Ns(n.Asset.Group.Name,n.Asset.Name)?{item:n,valid:!1}:t(e)})),vs.hookFunction("ValidationResolveAppearanceDiff",1,((e,t)=>(gi&&(e[3].fromModUser=gi(e[3])),t(e)))))}(e)}setLogger(e){!function(e){Js=e}(e)}typeBodyGroupNames(){return this}},Bi={Name:"Untrainers_Pamp",Random:!1,Left:174,Top:434,Priority:20,DefaultColor:["#FFFFFF"],ParentGroup:{},Layer:[{Name:"Base",AllowColorize:!0},{Name:"Patch",AllowColorize:!0},{Name:"Detail_2",AllowColorize:!0},{Name:"Detail_1",AllowColorize:!0},{Name:"Detail_3",AllowColorize:!0},{Name:"Tint",AllowColorize:!0,EditOpacity:!0},{Name:"Indicator",AllowColorize:!0,EditOpacity:!0},{Name:"Tabs",AllowColorize:!0}]},Li={CN:"Pampers尿布",EN:"Untrainers Diaper",RU:"Памперсовые диаперы"};const Di={Name:"Temp_Pamp",Random:!1,EditOpacity:!0,Left:160,Top:411,Priority:20,DefaultColor:["#d6efff","#7B7B7B","#8197A7","#4880B9","#B5A95B","#AAA44E"],ParentGroup:{},Layer:[{Name:"Back",AllowColorize:!0,Priority:-1},{Name:"Base",AllowColorize:!0},{Name:"Middle",AllowColorize:!0},{Name:"Tabs",AllowColorize:!0},{Name:"Wet",AllowColorize:!0},{Name:"Indicator",AllowColorize:!0}]},ki={EN:"Cutest Diaper",RU:"Самый лучший диапер",CN:"最好的尿布"};const Ii={Name:"Highchair",Random:!1,Left:55,Top:320,RemoveTime:15,Priority:40,DefaultColor:["#676285","#848484","#4a468d","#4a468d","#939394"],AllowLock:!0,AllowTighten:!0,Difficulty:8,Fetish:["ABDL"],Effect:[E.Freeze,E.MapImmobile],ParentGroup:{},Layer:[{Priority:3,Name:"Chair",AllowColorize:!0},{Priority:50,Name:"Tray",AllowColorize:!0},{Priority:45,Name:"Split",AllowColorize:!0},{Priority:2,Name:"Seat",AllowColorize:!0},{Priority:1,Name:"Legs",AllowColorize:!0}]},xi={EN:"Little's Highchair",RU:"Высокое кресло",CN:"小孩子的高椅"};vs.initWithMod(Ot),Mi.init((()=>{Mi.addImageMapping({"Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Base.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Base.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Patch.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Patch.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Detail_1.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Detail_1.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Detail_2.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Detail_2.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Detail_3.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Detail_3.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Indicator.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Indicator.png","Assets/Female3DCG/ItemPelvis/Untrainers_Pamp_Tabs.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Tabs.png","Assets/Female3DCG/ItemPelvis/Preview/Untrainers_Pamp.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Untrainer_Pamp/Untrainers_Pamp_Preview.png"}),Mi.addAsset("ItemPelvis",Bi,void 0,Li),Mi.addImageMapping({"Assets/Female3DCG/ItemPelvis/Temp_Pamp_Base.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Base.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Middle.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Middle.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Tabs.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Tabs.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Indicator.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Indicator.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Wet.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Wet.png","Assets/Female3DCG/ItemPelvis/Temp_Pamp_Back.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Back.png","Assets/Female3DCG/ItemPelvis/Preview/Temp_Pamp.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Preview.png"}),Mi.addImageMapping({"Assets/Female3DCG/Panties/Temp_Pamp_Base.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Base.png","Assets/Female3DCG/Panties/Temp_Pamp_Middle.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Middle.png","Assets/Female3DCG/Panties/Temp_Pamp_Tabs.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Tabs.png","Assets/Female3DCG/Panties/Temp_Pamp_Indicator.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Indicator.png","Assets/Female3DCG/Panties/Temp_Pamp_Wet.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Wet.png","Assets/Female3DCG/Panties/Temp_Pamp_Back.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Back.png","Assets/Female3DCG/Panties/Preview/Temp_Pamp.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/diapers/Temp/Preview.png"}),Mi.addAsset("ItemPelvis",Di,void 0,ki),Mi.addAsset("Panties",Di,void 0,ki),Mi.addImageMapping({"Assets/Female3DCG/ItemDevices/Highchair_Chair.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/highchair/Chair.png","Assets/Female3DCG/ItemDevices/Highchair_Tray.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/highchair/Tray.png","Assets/Female3DCG/ItemDevices/Highchair_Seat.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/highchair/Seat.png","Assets/Female3DCG/ItemDevices/Highchair_Split.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/highchair/Split.png","Assets/Female3DCG/ItemDevices/Highchair_Legs.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/highchair/Legs.png","Assets/Female3DCG/ItemDevices/Preview/Highchair.png":"https://zoe-64.github.io/ABCL/versions/beta/assets/items/other/highchair/Preview.png"}),Mi.addAsset("ItemDevices",Ii,void 0,xi)}));const Ni=()=>{"ChatRoom"===CurrentScreen&&cn.update()},Ti=async()=>{var e;(async()=>{const e=LZString.decompressFromBase64(Player.ExtensionSettings.ABCL),t=e?JSON.parse(e):{Settings:{},Stats:{}};if("2.0.0"===t.ModVersion){const e=t.Settings.Metabolism,n=t.Settings.DisableWetting;t.Settings={...Object.fromEntries(Object.entries(t.Settings).filter((([e])=>!["DisableWetting","DisableSoiling","Metabolism","CaregiverIDs"].includes(e))).map((([e,{value:t}])=>[e,t]))),PeeMetabolism:n?"Disabled":e,PoopMetabolism:n?"Disabled":e},t.ModVersion=void 0,t.Version="2.0.1"}const s=Pt({Settings:Et,Stats:_t,Version:"2.1.0"},t);n.debug({message:"Merged settings object",modStorageObject:s}),Player.ABCL=s})(),(async()=>{ns.innerHTML=`<sl-tab-group>\n  <sl-tab slot="nav" panel="general">General</sl-tab>\n  <sl-tab slot="nav" panel="messages">Messages</sl-tab>\n  <sl-tab slot="nav" panel="remote">Remote</sl-tab>\n  <sl-tab-panel name="general">\n    <sl-radio-group class="ABCLPeeMetabolismSelect" label="Select Pee Metabolism" name="pee-metabolism" value="${cn.settings.PeeMetabolism}">\n    <sl-radio-button value="Disabled">Disabled</sl-radio-button>\n    <sl-radio-button value="Slow">Slow</sl-radio-button>\n    <sl-radio-button value="Normal">Normal</sl-radio-button>\n    <sl-radio-button value="Fast">Fast</sl-radio-button>\n    <sl-radio-button value="Faster">Faster</sl-radio-button>\n    <sl-radio-button value="Fastest">Fastest</sl-radio-button>\n    </sl-radio-group>\n\n    <sl-radio-group class="ABCLPoopMetabolismSelect" label="Select Poop Metabolism" name="poop-metabolism" value="${cn.settings.PoopMetabolism}">\n    <sl-radio-button value="Disabled">Disabled</sl-radio-button>\n    <sl-radio-button value="Slow">Slow</sl-radio-button>\n    <sl-radio-button value="Normal">Normal</sl-radio-button>\n    <sl-radio-button value="Fast">Fast</sl-radio-button>\n    <sl-radio-button value="Faster">Faster</sl-radio-button>\n    <sl-radio-button value="Fastest">Fastest</sl-radio-button>\n    </sl-radio-group>\n\n    <sl-radio-group class="ABCLOnDiaperChangeSelect" label="Select On Diaper Change" name="on-diaper-change" value="${cn.settings.OnDiaperChange}">\n    <sl-radio-button value="Deny">Deny</sl-radio-button>\n    <sl-radio-button value="Ask">Ask</sl-radio-button>\n    <sl-radio-button value="Allow">Allow</sl-radio-button>\n    </sl-radio-group>\n\n    <sl-checkbox class="ABCLDisableClothingStains" name="disable-clothing-stains" checked="${cn.settings.DisableClothingStains}">Disable Clothing Stains</sl-checkbox>\n    <sl-checkbox class="ABCLDisableDiaperStains" name="disable-diaper-stains" checked="${cn.settings.DisableDiaperStains}">Disable Diaper Stains</sl-checkbox>\n  </sl-tab-panel>\n  <sl-tab-panel name="messages">\n  <div>\n  <h1 class="ABCLMessageVisibility"> Status messages for self: </h1>\n  <div style="margin-left: 1em;">\n    <sl-checkbox class="ABCLBladderStatusMessage" name="bladder-StatusMessage" checked="${cn.settings.getStatusMessageSetting("Bladder")}">Bladder</sl-checkbox>\n    <sl-checkbox class="ABCLBowelStatusMessage" name="bowel-StatusMessage" checked="${cn.settings.getStatusMessageSetting("Bowel")}">Bowel</sl-checkbox>\n    <sl-checkbox class="ABCLSoilinessStatusMessage" name="soiliness-StatusMessage" checked="${cn.settings.getStatusMessageSetting("Soiliness")}">Soiliness</sl-checkbox>\n    <sl-checkbox class="ABCLWetnessStatusMessage" name="wetness-StatusMessage" checked="${cn.settings.getStatusMessageSetting("Wetness")}">Wetness</sl-checkbox>\n    <sl-checkbox class="ABCLMentalRegressionStatusMessage" name="mental-regression-StatusMessage" checked="${cn.settings.getStatusMessageSetting("MentalRegression")}">Mental Regression</sl-checkbox>\n    <sl-checkbox class="ABCLIncontinenceStatusMessage" name="incontinence-StatusMessage" checked="${cn.settings.getStatusMessageSetting("Incontinence")}">Incontinence</sl-checkbox>\n    <sl-checkbox class="ABCLPuddleSizeStatusMessage" name="puddle-size-StatusMessage" checked="${cn.settings.getStatusMessageSetting("PuddleSize")}">Puddle Size</sl-checkbox>\n  </div>\n  </div>\n  <div>\n  <h1 class="ABCLMessageVisibility"> Message visibility for others: </h1>\n  <div style="margin-left: 1em;"> \n    <sl-checkbox class="ABCLChangeDiaperVisibility" name="change-diaper-visibility" checked="${cn.settings.getPublicMessage("changeDiaper")}">Change Diaper</sl-checkbox>\n    <sl-checkbox class="ABCLCheckDiaperVisibility" name="check-diaper-visibility" checked="${cn.settings.getPublicMessage("checkDiaper")}">Check Diaper</sl-checkbox>\n    <sl-checkbox class="ABCLLickPuddleVisibility" name="lick-puddle-visibility" checked="${cn.settings.getPublicMessage("lickPuddle")}">Lick Puddle</sl-checkbox>\n    <sl-checkbox class="ABCLWetDiaperVisibility" name="wet-diaper-visibility" checked="${cn.settings.getPublicMessage("wetDiaper")}">Wet Diaper</sl-checkbox>\n    <sl-checkbox class="ABCLWetClothingVisibility" name="wet-clothing-visibility" checked="${cn.settings.getPublicMessage("wetClothing")}">Wet Clothing</sl-checkbox>\n    <sl-checkbox class="ABCLSoilDiaperVisibility" name="soil-diaper-visibility" checked="${cn.settings.getPublicMessage("soilDiaper")}">Soil Diaper</sl-checkbox>\n    <sl-checkbox class="ABCLSoilClothingVisibility" name="soil-clothing-visibility" checked="${cn.settings.getPublicMessage("soilClothing")}">Soil Clothing</sl-checkbox>\n    <sl-checkbox class="ABCLUsePottyVisibility" name="use-potty-visibility" checked="${cn.settings.getPublicMessage("usePotty")}">Use Potty</sl-checkbox>\n    <sl-checkbox class="ABCLUseToiletVisibility" name="use-toilet-visibility" checked="${cn.settings.getPublicMessage("useToilet")}">Use Toilet</sl-checkbox>\n    <sl-checkbox class="ABCLWipePuddleVisibility" name="wipe-puddle-visibility" checked="${cn.settings.getPublicMessage("wipePuddle")}">Wipe Puddle</sl-checkbox>\n  <sl-checkbox class="ABCLStatusMessagesVisibility" name="status-messages-visibility" checked="${cn.settings.getPublicMessage("statusMessages")}">Status Messages</sl-checkbox>\n  </div>\n  </div>\n  </sl-tab-panel>\n\n  <sl-tab-panel name="remote">\n    In development\n      </sl-tab-panel>\n    </sl-tab-group>\n  </sl-tab-panel>\n</sl-tab-group>\n  `;const e=Wt(ns,".ABCLPeeMetabolismSelect"),t=Wt(ns,".ABCLPoopMetabolismSelect"),n=Wt(ns,".ABCLOnDiaperChangeSelect"),s=Wt(ns,".ABCLDisableDiaperStains"),i=Wt(ns,".ABCLDisableClothingStains"),o={useToilet:Wt(ns,".ABCLUseToiletVisibility"),wipePuddle:Wt(ns,".ABCLWipePuddleVisibility"),changeDiaper:Wt(ns,".ABCLChangeDiaperVisibility"),checkDiaper:Wt(ns,".ABCLCheckDiaperVisibility"),lickPuddle:Wt(ns,".ABCLLickPuddleVisibility"),wetDiaper:Wt(ns,".ABCLWetDiaperVisibility"),wetClothing:Wt(ns,".ABCLWetClothingVisibility"),soilDiaper:Wt(ns,".ABCLSoilDiaperVisibility"),soilClothing:Wt(ns,".ABCLSoilClothingVisibility"),usePotty:Wt(ns,".ABCLUsePottyVisibility"),statusMessages:Wt(ns,".ABCLStatusMessagesVisibility")},a={Bladder:Wt(ns,".ABCLBladderStatusMessage"),Bowel:Wt(ns,".ABCLBowelStatusMessage"),Incontinence:Wt(ns,".ABCLIncontinenceStatusMessage"),MentalRegression:Wt(ns,".ABCLMentalRegressionStatusMessage"),PuddleSize:Wt(ns,".ABCLPuddleSizeStatusMessage"),Soiliness:Wt(ns,".ABCLSoilinessStatusMessage"),Wetness:Wt(ns,".ABCLWetnessStatusMessage")};e.addEventListener("sl-change",(e=>{cn.settings.PeeMetabolism=e.target.value})),t.addEventListener("sl-change",(e=>{cn.settings.PoopMetabolism=e.target.value})),n.addEventListener("sl-change",(e=>{cn.settings.OnDiaperChange=e.target.value})),s.addEventListener("sl-change",(e=>{cn.settings.DisableDiaperStains=e.target.checked})),i.addEventListener("sl-change",(e=>{cn.settings.DisableClothingStains=e.target.checked}));for(const e of Object.keys(a))a.hasOwnProperty(e)&&a[e]?.addEventListener("sl-change",(t=>{cn.settings.setStatusMessageSetting(e,t.target.checked)}));for(const e of Object.keys(o))o.hasOwnProperty(e)&&o[e].addEventListener("sl-change",(t=>{cn.settings.setPublicMessage(e,t.target.checked)}));on.appendChild(ns),PreferenceRegisterExtensionSetting({Identifier:"ABCL",ButtonText:`${Bt} Settings`,Image:"https://zoe-64.github.io/ABCL/versions/beta/assets/abcl.png",run:()=>{DrawButton(1815,75,90,90,"","White","Icons/Exit.png")},click:()=>{MouseIn(1815,75,90,90)&&PreferenceSubscreenExtensionsExit()},exit:()=>(ns.classList.add("ABCLHidden"),$t(),!0),load:()=>{function r(e,t){t?e.setAttribute("checked","true"):e.removeAttribute("checked")}ns.classList.remove("ABCLHidden"),e.setAttribute("value",cn.settings.PeeMetabolism),t.setAttribute("value",cn.settings.PoopMetabolism),n.setAttribute("value",cn.settings.OnDiaperChange),r(i,cn.settings.DisableClothingStains),r(s,cn.settings.DisableDiaperStains);for(const e of Object.keys(a))if(a.hasOwnProperty(e)){const t=cn.settings.getStatusMessageSetting(e);r(a[e],t??!1)}for(const e of Object.keys(o))if(o.hasOwnProperty(e)){const t=cn.settings.getPublicMessage(e);r(o[e],t)}}})})(),Ot.hookFunction("DialogMenuMapping.activities.GetClickStatus",1,((e,t)=>{const[n,s,i]=e;return s?t(e):null})),Ot.hookFunction("DialogChangeMode",1,(async(e,t)=>{const[n]=e;if(t(e),"activities"!==n)return;const s=CurrentCharacter?.FocusGroup?CurrentCharacter:Player,i=await Rt("#dialog-activity-grid"),o=s.FocusGroup?.Name;if(o)for(const{activity:e}of Xn){if(!e)continue;const t=new qn(e.ID,e.Name,e.Image,e.OnClick,e.Target,e.TargetSelf,e.Criteria);t.fitsCriteria(s,o)&&(qn.isInserted(e.ID)||i.appendChild(t.createButton()))}})),CommandCombine(Kn),e=[],Ot.hookFunction("TextLoad",5,((t,n)=>{if(!e.some((e=>e.module===CurrentModule&&e.id===CurrentScreen)))return n(t)})),e.forEach((e=>{window[`${e.id}Background`]="Sheet";const{KeyUp:t,Click:n,...s}=e.functions,i={...s,KeyUp:n=>{"Escape"===n.key&&window[`${e.id}Exit`](),t?.(n)},Click:t=>{MouseIn(1815,75,90,90)&&window[`${e.id}Exit`](),n?.(t)}};window[`${e.id}ScreenFunctions`]=i,Object.entries(i).forEach((([t,n])=>{window[`${e.id}${t}`]=n}))})),es(),ss(new as),ss(new rs),rn(),window.ABCL={inModSubscreen:()=>Boolean(on.querySelector(".ABCLSettingPage")?.classList.contains("ABCLHidden")),isABCLPlayer:Kt,sendDataToAction:Jn,sendUpdateMyData:Zn,sendRequestOtherDataPacket:Qn},setInterval(Ni,6e4),n.info("Ready.")};null==CurrentScreen||"Login"===CurrentScreen?Ot.hookFunction("LoginResponse",zt.OBSERVE,((e,t)=>{t(e);const n=e[0];if("InvalidNamePassword"===n)return;const{Name:s,AccountName:i}=n;"string"==typeof s&&"string"==typeof i&&Ti()})):Ti()}();
//# sourceMappingURL=abcl.js.map
